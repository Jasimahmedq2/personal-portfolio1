$(function(){Chat.pingInterval=setInterval(function(){if(!document.hidden)$.ajax("/favicon.ico?v="+Math.random(),{error:function(xmlHttpRequest){if(xmlHttpRequest&&xmlHttpRequest.readyState==0){Chat.socket_disconnect_type="ajax_ping_pong";Chat.socket.close()}},type:"GET"})},30*1E3);$(window).on("load",function(){$("#content").removeClass("preload")});$("body").on("click",".copy-button",function(){var $jscomp$this=this;setTimeout(function(){var copy_text=$("<input>");$($jscomp$this).append(copy_text);
copy_text.val(window.meeting_link).select();document.execCommand("copy");general_toast("Link copied to the clipboard ");copy_text.remove()},0)});track_student_chat_banners()});var href="";
$(document).on("click","a",function(e){var target=$(this);if(target.parents("#react_root").length);else{var target_page=target.attr("target");href=target.attr("href");if(target_page!=="_blank"&&typeof href!=="undefined"&&href[0]!=="#"&&!href.match(/\/chat/gi))if(typeof window.onbeforeunload==="function"&&window.onbeforeunload()){e.preventDefault();$(".chat_alert_modal").modal("show")}}});
$(document).on("click",".chat_alert_modal .yes",function(e){if(href!==""&&typeof href[0]!=="undefined"&&href[0]!=="#"){window.onbeforeunload=null;window.location.href=href}});$(document).on("click",".chat_alert_modal .no",function(e){$(".chat_alert_modal").modal("hide");href=""});
$(document).on("click",".preview_image_modal_link",function(e){var image_path=$(this).closest(".image_preview_path").attr("path");if(!image_path)return;$("#preview_image_modal").find(".preview_image").attr("src",image_path);$("#preview_image_modal").find("#download_preview_image").attr("href",image_path);$("#preview_image_modal").modal("show")});
$(document).on("click","#preview_image_modal #close_preview_image",function(){$("#preview_image_modal").find(".preview_image").attr("src","");$("#preview_image_modal").find("#download_preview_image").attr("href","");$("#preview_image_modal").modal("hide")});$(document).on("click",".modal.closable .modal-header .close",function(e){$(e.target).closest(".modal").modal("hide")});
function popovers(){$(".rewards_popover").each(function(){$(this).popover({trigger:"hover",container:$("#invitation_internship_detail_modal"),placement:"bottom",html:true,sanitize:false,content:'<div class="close_tooltip_container"></div><div class="popover-content">'+$(this).attr("popover_content")+"</div>"})})}
function track_student_chat_banners(){var category=$("#dashboard-notification-image").attr("data-category");var action=$("#dashboard-notification-image").attr("data-action");var label=$("#dashboard-notification-image").attr("data-label");if(category&&action&&label)if(typeof dataLayer!=="undefined"){dataLayer.push({"event":"campaign_try","eventCategory":category,"eventAction":action,"eventLabel":label});dataLayer.push({"event":"chat_view","view":category})}};var is_valid_file=false;var multimedia_mime_types=["audio/mpeg","audio/aac","audio/wav","audio/x-aiff","video/mp4","video/quicktime","video/x-msvideo","video/x-ms-wmv","video/x-flv","video/webm","audio/mp4","audio/m4a","audio/x-m4a","audio/ogg"];var mime_mapping={"application/zip":["504b0304","504b0506","504b0708"],"application/pdf":["25504446"],"application/vnd.ms-office":["d0cf11e0"],"image/png":["89504e470d0a1a0a"],"image/jpeg":["ffd8"]};
var extensions={"application/zip":["zip","docx","pptx","xlsx"],"application/vnd.ms-office":["doc","ppt","xls","xlsx","docx"],"application/pdf":["pdf"],"image/png":["png"],"image/jpeg":["jpg","jpeg"],"audio/mpeg":["mp3"],"audio/aac":["aac"],"audio/wav":["wav"],"audio/x-aiff":["aiff"],"video/mp4":["mp4"],"video/quicktime":["mov"],"video/x-msvideo":["avi"],"video/x-ms-wmv":["wmv"],"video/x-flv":["flv"],"video/webm":["webm"],"audio/m4a":["m4a"],"audio/mp4":["m4a"],"audio/ogg":["opus"],"audio/x-m4a":["m4a"]};
function getFileHeader(file,callback){var fileReader=new FileReader;fileReader.onloadend=function(e){var arr=(new Uint8Array(e.target.result)).subarray(0,24);var fileExt=file.name.split(".").slice(-1)[0].toUpperCase();var header=Array.from(arr).map(function(b){return b.toString(16).padStart(2,"0")}).join("");var mimeType=null;if(multimedia_mime_types.includes(file.type))mimeType=file.type;else mimeType=getMimeType(header);if(!mimeType){callback(false,"Invalid File");return}else if(!doesExtMatchMimeType(fileExt.toLowerCase(),
mimeType)){callback(false,"Invalid file "+mimeType);return}else callback(true,"",file)};fileReader.readAsArrayBuffer(file)}function getMimeType(header){return Object.keys(mime_mapping).filter(function(mimeType){return mime_mapping[mimeType].filter(function(signature){return header.toLowerCase().startsWith(signature.toLowerCase())})[0]&&mimeType})[0]||null}function doesExtMatchMimeType(ext,mimeType){return extensions[mimeType]&&extensions[mimeType].includes(ext)||false}
function validate_file_extension(file,callback){if(window.FileReader){getFileHeader(file,callback);return is_valid_file}else;};var file_array=[];var max_file_count=3;var max_file_size=10;var file_count=0;var total_file_size=0;$(document).ready(function(){$("#file, #file_more").change(function(){$("#message_container").hide().html("");if(max_file_size*1024*1024<total_file_size){$("#message_container").show().html("Total permitted file upload size is "+max_file_size+"MB");setTimeout(function(){$("#message_container").hide().html("")},5E3)}else readURL(this);$("#file").val("");$("#file_more").val("")})});
$(document).on("click","#chat_message .close",function(){reset_form_validations("chat_message_form");$("#preview_container").hide();$("#preview_container").html("");$("#file").val("");$("#file_more").val("")});
$(document).on("click",".send_message, .group_invite",function(){if(typeof application_status!="undefined"&&application_status=="invite"){$("#referral").val("invitation");$("#chat_message .default_icon").hide();$("#chat_message .invite_icon").show();$("#internship_chat_guidelines").hide();if(employment_type==="job")$("#chat_send_button").addClass("invite_job");else $("#chat_send_button").addClass("invite");$("#loading_spinner_chat_message").hide()}else{$("#referral").val("list_view");$("#chat_message .default_icon").show();
$("#chat_message .invite_icon").hide();if(employment_type==="internship")$("#internship_chat_guidelines").show();$("#chat_send_button").removeClass("invite");$("#chat_send_button").removeClass("invite_job");$("#loading_spinner_chat_message").hide()}if($(this).hasClass("disabled"))return;reset_form_validations("chat_message_form");reset_chat_modal();$("#message_input").removeClass("valid");var application_id=$(this).attr("application_id");if(typeof application_status!="undefined"&&application_status==
"invite"){if(page_type=="application_detail_view")var name=$(".applicant_first_name").text();else if(typeof selected_application_ids!="undefined"&&selected_application_ids.length>0)var name="{Candidate_name}";else var name=$.trim($("#individual_application_"+application_id).find(".applicant_first_name").text());$("#referral").val("invitation");if(employment_type==="job")$("#message_input").val("Hi "+name+", \n\nI am "+employer_first_name+" from "+company_name+". We are currently hiring for "+job_title+
" role. I came across your profile at Internshala and feel you would be the right fit for our team. Please view the job details once and let me know if you are interested. We will discuss the next steps.\n\nThanks,\n"+employer_full_name+"\n"+company_name);else $("#message_input").val("Hi "+name+", \n\nWe came across your profile for "+profile+" internship at "+company_name+" and quite liked it. You may view the internship details and if you are interested in the opportunity, please reply to this message and we would let you know regarding next steps.\n\nThanks,\n"+
employer_full_name+"\n"+company_name);$("#message_input").trigger("input");if(employment_type==="job"){$("#chat_message #myModalLabel").html("Get in touch");$("#chat_send_button").addClass("invite_job")}else{$("#chat_message #myModalLabel").html("Invite Candidate");$("#chat_send_button").addClass("invite")}$("#chat_message .default_icon").hide();$("#chat_message .invite_icon").show();if(typeof selected_application_ids!="undefined"&&selected_application_ids.length>0){$("#chat_message .names_label").html("To:");
$("#group_invite_personalized_message").show();$("#chat_message .names").addClass("group_invite_names")}}else{$("#chat_message #myModalLabel").html("Internshala Chat");$("#chat_message .default_icon").show();$("#chat_message .invite_icon").hide();$("#chat_send_button").removeClass("invite");$("#chat_send_button").removeClass("invite_job")}$("#chat_message").modal("show");if(typeof application_status!="undefined"&&application_status=="invite")if(page_type=="application_detail_view"){$("#internship_id").val($("#application_internship_id").html());
$("#name_list").html("<span class='name'>"+name+"</span>");$("#application_ids").val($("#student_application_id").html())}else if(selected_application_ids.length>0)chat_message_to(selected_application_ids);else chat_message_to(application_id);else chat_message_to(application_id)});
$(document).on("click","#preview_container .frame-close",function(e){var file_name=$(this).attr("file_name");$(e.target).closest(".frame-container").remove();if(typeof file_array[file_name]!="undefined"){var size=file_array[file_name].size;total_file_size-=size;delete file_array[file_name];file_count--}if(file_count<3)$(".attachment").show();if(file_count==0){$("#file_count_hint").hide();$("#file_type_hint").show()}else{$("#file_count_hint").show();$("#file_type_hint").hide()}});
$(document).on("click",".chat_modal_button",function(){if(typeof application_status!="undefined"&&application_status=="invite"){$("#chat_message .default_icon").hide();$("#chat_message .invite_icon").show();if(employment_type==="job"){$("#chat_message #myModalLabel").html("Get in touch");$("#chat_send_button").addClass("invite_job")}else{$("#chat_message #myModalLabel").html("Invite Candidate");$("#chat_send_button").addClass("invite")}}else{$("#chat_message .default_icon").show();$("#chat_message .invite_icon").hide();
$("#chat_message #myModalLabel").html("Internshala Chat");$("#chat_send_button").removeClass("invite");$("#chat_send_button").removeClass("invite_job")}if(employment_type==="internship")$("#internship_chat_guidelines").show();$("#referral").val("application_detail");$("#chat_message_form #application_ids").val($("#student_application_id").html());$("#chat_message_form #internship_id").val($("#application_internship_id").html());$("#chat_message_form #name_list").html("<span class='name'>"+$("#student_name").html()+
"</span>");$("#chat_message").modal("show")});
$(document).on("click","#group_chat_message",function(){if($(this).children(".group_action_items").hasClass("disabled"))return;$("#referral").val("bulk");if(employment_type==="internship")$("#internship_chat_guidelines").show();$("#chat_send_button").removeClass("invite");$("#chat_send_button").removeClass("invite_job");$("#chat_send_button").show();$("#loading_spinner_chat_message").hide();reset_chat_modal();if(typeof application_status!="undefined"&&application_status=="invite"){$("#chat_message .default_icon").hide();
$("#chat_message .invite_icon").show();if(employment_type==="job")$("#chat_message #myModalLabel").html("Get in touch");else $("#chat_message #myModalLabel").html("Invite Candidate")}else{$("#chat_message .default_icon").show();$("#chat_message .invite_icon").hide();$("#chat_message #myModalLabel").html("Internshala Chat")}chat_message_to(selected_application_ids);$("#chat_message").modal("show")});
var chat_message_to=function(rowids){if(typeof rowids==="string")rowids=[rowids];var names="";var names_limit=5;for(var i=0;i<rowids.length;i++){var name=get_name_by_application_id(rowids[i]);if(i<names_limit)names+="<span class='name'>"+name+"</span>";else break}var more_count=rowids.length>names_limit?rowids.length-names_limit:0;if(more_count>0)names+="<span class='name'>+"+more_count+" more</span>";$("#internship_id").val(internship_id);$("#name_list").html(names);$("#application_ids").val(rowids.toString())};
function chat_message(){$("#chat_message_form").validate({ignore:[],onfocusout:function(element){this.element(element)},rules:{file_to_upload:{accept:"zip,pdf,doc,docx,xls,xlsx,ppt,pptx,jpeg,jpg,png,msword,application/*",size:max_file_size},message:{required:true,maxlength:3E3}},errorPlacement:function(label,element){if(element.attr("name")==="message")label.insertAfter(element.parent());else if(element.attr("name")==="file_to_upload")label.insertAfter("#message_form");else label.insertAfter(element)},
highlight:function(label){$(label).closest(".form-group").addClass("has-error");$(label).closest(".form-group").removeClass("has-success");$(label).closest("input").addClass("error");$(label).closest("input").removeClass("valid")},success:function(label){$(label).closest(".form-group").addClass("has-success");$(label).closest(".form-group").removeClass("has-error");$(label).closest("input").addClass("valid");$(label).closest("input").removeClass("error")},submitHandler:function(){var url="";if(typeof application_status!=
"undefined"&&application_status=="invite")url="/employer/invitation";else url="/chat/send_message_from_employer_dashboard";$("#chat_send_button").hide();$("#loading_spinner_chat_message").show();if(typeof is_nprogess_shown!=="undefined"&&is_nprogess_shown==false){NProgress.start();is_nprogess_shown=true}$(".loading_image").show();var form=document.querySelector("#chat_message_form");var fd=new FormData(form);var i=1;for(var key in file_array){fd.append("file_to_upload_"+i,file_array[key]);i++}if(typeof application_status!=
"undefined"&&application_status=="invite"){fd.append("action","invite");fd.append("recommend_ids",fd.get("application_ids"));fd.append("page_type",page_type)}NProgress.start();$(".loading_image").show();$.ajax(url,{data:fd,processData:false,contentType:false,success:chat_message_success,error:onError,type:"POST"});return false}})}
var chat_message_success=function(data){$("#chat_send_button").show();$("#loading_spinner_chat_message").hide();try{NProgress.done();$(".loading_image").hide();is_nprogess_shown=false;reset_chat_modal();if(!data.success)if(data.auto_blocked!=="undefined"&&data.auto_blocked)window.location.href="/account-hold/"+data.user_id;else throw_semi_error(data.errorThrown);else{reset_form_validations("chat_message_form");$(".preview_container").hide();$(".details .file_name").html("");$(".details .file_size").html("");
$(".frame-ext").html("");$("#file").val("");$("#file_more").val("");$("#message_input").val("");$("#message_input").trigger("input");$("#chat_message").modal("hide");if(typeof page_type!="undefined"&&page_type=="application_list_view"){$("#chat_messages").attr("href","/chat/c-/i-"+job_id);$("#chat_messages").removeClass("no_chat");$("#chat_messages #no_chat_tooltip").hide();$("#status_selectors_container #chat_messages_count").hide();action_taken++}if(typeof data.bulk_request_enabled!="undefined"&&
data.bulk_request_enabled&&page_type=="application_list_view")$("#group_chat_message").children(".group_action_items").addClass("disabled");else $("#group_chat_message").children(".group_action_items").removeClass("disabled");if(page_type=="application_detail_view"&&(typeof application_status!="undefined"&&application_status=="invite"))load_message_and_application_on_status_change(data);else{var application_ids=typeof data.application_ids!=="undefined"?data.application_ids:null;if(typeof page_type!==
"undefined"&&page_type=="application_list_view"){to_show_unprocessed_applications_alert=data.to_show_unprocessed_applications_alert?1:0;updateExcessUnprocessedNotification();if(typeof application_status!="undefined"&&application_status=="invite"){var recommend_ids=data.recommend_ids;var applications_cards_ids="";recommend_ids.forEach(function(recommend_id){applications_cards_ids+=(applications_cards_ids.length>0?", ":"")+"#individual_application_"+recommend_id});$(applications_cards_ids).slideUp(500,
function(){load_more_invite_applicants()});$(".action_container").show();hide_elements();unset_variables();load_more_invite_applicants();if(data.to_show_success_modal)throw_success(data.successMsg,"","Okay");else general_toast(data.successMsg);NProgress.done();$(".loading_image").hide();$(".invited_applications_count").text(parseInt($("#invited_applications_count").text())-recommend_ids.length);$("#filtered_results_count").text(parseInt($("#filtered_results_count").text()-recommend_ids.length));$("#total_results_count").text(parseInt($("#total_results_count").text()-
recommend_ids.length))}else list_view_success(data)}else{var success_msg=data.successMsg;general_toast(success_msg);var chat_messages_unread_array=data.chat_messages_unread_array;for(var i=0;i<application_ids.length;i++){var application_id=application_ids[i];var unread_message_count=0;if(typeof chat_messages_unread_array[application_id]!=="undefined"){unread_message_count=chat_messages_unread_array[application_id]["unread_chat_messages"];if(unread_message_count>0)$(".chat_link .unread_message_count").text(unread_message_count);
else $(".chat_link .unread_message_count").hide()}else $(".chat_link .unread_message_count").hide();if(typeof chat_messages_unread_array[application_id]!=="undefined"){conversation_id=chat_messages_unread_array[application_id]["conversation_id"];$(".chat_link").attr("href","/chat/c-"+conversation_id);$(".chat_link").show()}$(".chat_modal_button").hide()}}if(typeof employerChatEducationPopoverType!=="undefined")employerChatEducationPopoverType=0;if(application_ids&&typeof is_chat_conversation_exist!==
"undefined")if(application_ids.length>0)is_chat_conversation_exist=true}}}catch(e){throw_error(e);NProgress.done();is_nprogess_shown=false;$(".loading_image").hide()}};
function list_view_success(data){var success_msg=data.successMsg;var application_ids=data.application_ids||[];var chat_messages_unread_array=data.chat_messages_unread_array;var message_sent_at=data.message_sent_at;if(data.to_show_success_modal)throw_success(success_msg,"","Okay");else general_toast(success_msg);for(var i=0;i<application_ids.length;i++){var application_id=application_ids[i];var unread_message_count=0;if(typeof chat_messages_unread_array[application_id]!=="undefined"){unread_message_count=
chat_messages_unread_array[application_id]["unread_chat_messages"];if(unread_message_count>0){$(".chat_link_"+application_id+" .btn .unread_message_count_container").show();$(".chat_link_"+application_id+" .btn .unread_message_count").text(unread_message_count)}else $(".chat_link_"+application_id+" .btn .unread_message_count_container").hide()}else $(".chat_link_"+application_id+" .btn").text("Messages");var conversation_id=0;if(typeof chat_messages_unread_array[application_id]!=="undefined"){conversation_id=
chat_messages_unread_array[application_id]["conversation_id"];$(".chat_link_"+application_id).attr("href","/chat/c-"+conversation_id);$(".chat_link_"+application_id).show();$(".chat_link_"+application_id).removeClass("chat_link_conversation_");$(".chat_link_"+application_id).addClass("chat_link_conversation_"+conversation_id)}$(".send_message_button_"+application_id).hide()}}
function readURL(input){var input_files=input.files;var fc=input_files.length;if(fc>3||file_count+fc>3){$("#message_container").show().html("You can attach maximum 3 files");setTimeout(function(){$("#message_container").hide().html("")},5E3);return}else for(i=0;i<fc;i++){var files=input_files[i];validate_file_extension(files,file_check_call_back)}}
function compute_file_size(size){if(size<1024)return size+" B";else if(size<1024*1024)return Math.round(size/1024*100)/100+" KB";else return Math.round(size/1024/1024*100)/100+" MB"}
function create_preview_template(count,name,size,ext){var preview="";preview='<div class="preview frame-ext'+(ext.toLowerCase()==="pdf"?" pdf":"")+'" id="preview_text"><div>'+ext+"</div></div>";var html='<div class="frame-container preview_container_'+count+'" >'+preview+'<div class="details"><div class="file-name">'+name+'</div><div class="file-size">'+size+'</div></div><button type="button" class="frame-close" file_name="'+name+'"><i class="ic-24-cross"></i></button></div>';return html}
$(document).on("click",".close",function(){reset_chat_modal()});
function file_check_call_back(success,msg,file){if(!success){$("#message_container").show().html(msg);setTimeout(function(){$("#message_container").hide().html("")},5E3)}else{var type=file.type;var file_size=compute_file_size(file.size);var fileExt=file.name.split(".").slice(-1)[0];var ext=["zip","pdf","doc","docx","xls","xlsx","ppt","pptx","jpeg","jpg","png"];if(ext.includes(fileExt)){if(typeof file_array[file.name]==="undefined"){total_file_size+=file.size;if(max_file_size*1024*1024<total_file_size){msg=
"Total permitted file upload size is "+max_file_size+"MB";total_file_size-=file.size}else{file_count++;file_array[file.name]=file;$("#preview_container").show();$("#preview_container").append(create_preview_template(file_count,file.name,file_size,fileExt.toUpperCase()))}}}else{$(".details .file_size").html("<br>");$(".preview_container").show();$(".details .file_name").html("Invalid file selected");$("#file").val("");$("#file_more").val("")}}if(file_count==3)$(".attachment").hide();if(file_count==
0){$("#file_count_hint").hide();$("#file_type_hint").show()}else{$("#file_count_hint").show();$("#file_type_hint").hide()}if(msg){$("#message_container").show().html(msg);setTimeout(function(){$("#message_container").hide().html("")},5E3)}}
function reset_chat_modal(){file_array=[];file_count=0;total_file_size=0;$(".attachment").show();$("#message_input").val("");$("#preview_container").html("");$("#group_invite_personalized_message").hide();$("#chat_message .names_label").html("Message to:");$("#chat_message .names").removeClass("group_invite_names");reset_form_validations("chat_message_form")}
$(document).on("input","#message_input",function(){if(this.clientHeight<this.scrollHeight)$(this).parent().find(".attachment").addClass("scrollbar_visible");else $(this).parent().find(".attachment").removeClass("scrollbar_visible")});/*
 Chosen, a Select Box Enhancer for jQuery and Prototype
by Patrick Filler for Harvest, http://getharvest.com

Version 1.8.7
Full source at https://github.com/harvesthq/chosen
Copyright (c) 2011-2018 Harvest http://getharvest.com

MIT License, https://github.com/harvesthq/chosen/blob/master/LICENSE.md
This file is generated by `grunt build`, do not edit it by hand.
*/
(function(){var $,AbstractChosen,Chosen,SelectParser,bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){for(var key in parent)if(hasProp.call(parent,key))child[key]=parent[key];function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty;SelectParser=function(){function SelectParser(){this.options_index=0;this.parsed=[]}SelectParser.prototype.add_node=
function(child){if(child.nodeName.toUpperCase()==="OPTGROUP")return this.add_group(child);else return this.add_option(child)};SelectParser.prototype.add_group=function(group){var group_position,i,len,option,ref,results1;group_position=this.parsed.length;this.parsed.push({array_index:group_position,group:true,label:group.label,title:group.title?group.title:void 0,children:0,disabled:group.disabled,classes:group.className});ref=group.childNodes;results1=[];for(i=0,len=ref.length;i<len;i++){option=ref[i];
results1.push(this.add_option(option,group_position,group.disabled))}return results1};SelectParser.prototype.add_option=function(option,group_position,group_disabled){if(option.nodeName.toUpperCase()==="OPTION"){if(option.text!==""){if(group_position!=null)this.parsed[group_position].children+=1;this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:option.value,text:option.text,html:option.innerHTML,title:option.title?option.title:void 0,selected:option.selected,
disabled:group_disabled===true?group_disabled:option.disabled,group_array_index:group_position,group_label:group_position!=null?this.parsed[group_position].label:null,classes:option.className,style:option.style.cssText})}else this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:true});return this.options_index+=1}};return SelectParser}();SelectParser.select_to_array=function(select){var child,i,len,parser,ref;parser=new SelectParser;ref=select.childNodes;for(i=0,
len=ref.length;i<len;i++){child=ref[i];parser.add_node(child)}return parser.parsed};AbstractChosen=function(){function AbstractChosen(form_field,options1){this.form_field=form_field;this.options=options1!=null?options1:{};this.label_click_handler=bind(this.label_click_handler,this);if(!AbstractChosen.browser_is_supported())return;this.is_multiple=this.form_field.multiple;this.set_default_text();this.set_default_values();this.setup();this.set_up_html();this.register_observers();this.on_ready()}AbstractChosen.prototype.set_default_values=
function(){this.click_test_action=function(_this){return function(evt){return _this.test_active_click(evt)}}(this);this.activate_action=function(_this){return function(evt){return _this.activate_field(evt)}}(this);this.active_field=false;this.mouse_on_container=false;this.results_showing=false;this.result_highlighted=null;this.is_rtl=this.options.rtl||/\bchosen-rtl\b/.test(this.form_field.className);this.allow_single_deselect=this.options.allow_single_deselect!=null&&this.form_field.options[0]!=null&&
this.form_field.options[0].text===""?this.options.allow_single_deselect:false;this.disable_search_threshold=this.options.disable_search_threshold||0;this.disable_search=this.options.disable_search||false;this.enable_split_word_search=this.options.enable_split_word_search!=null?this.options.enable_split_word_search:true;this.group_search=this.options.group_search!=null?this.options.group_search:true;this.search_contains=this.options.search_contains||false;this.single_backstroke_delete=this.options.single_backstroke_delete!=
null?this.options.single_backstroke_delete:true;this.max_selected_options=this.options.max_selected_options||Infinity;this.inherit_select_classes=this.options.inherit_select_classes||false;this.display_selected_options=this.options.display_selected_options!=null?this.options.display_selected_options:true;this.display_disabled_options=this.options.display_disabled_options!=null?this.options.display_disabled_options:true;this.include_group_label_in_selected=this.options.include_group_label_in_selected||
false;this.max_shown_results=this.options.max_shown_results||Number.POSITIVE_INFINITY;this.case_sensitive_search=this.options.case_sensitive_search||false;return this.hide_results_on_select=this.options.hide_results_on_select!=null?this.options.hide_results_on_select:true};AbstractChosen.prototype.set_default_text=function(){if(this.form_field.getAttribute("data-placeholder"))this.default_text=this.form_field.getAttribute("data-placeholder");else if(this.is_multiple)this.default_text=this.options.placeholder_text_multiple||
this.options.placeholder_text||AbstractChosen.default_multiple_text;else this.default_text=this.options.placeholder_text_single||this.options.placeholder_text||AbstractChosen.default_single_text;this.default_text=this.escape_html(this.default_text);return this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||AbstractChosen.default_no_result_text};AbstractChosen.prototype.choice_label=function(item){if(this.include_group_label_in_selected&&item.group_label!=
null)return"<b class='group-name'>"+this.escape_html(item.group_label)+"</b>"+item.html;else return item.html};AbstractChosen.prototype.mouse_enter=function(){return this.mouse_on_container=true};AbstractChosen.prototype.mouse_leave=function(){return this.mouse_on_container=false};AbstractChosen.prototype.input_focus=function(evt){if(this.is_multiple){if(!this.active_field)return setTimeout(function(_this){return function(){return _this.container_mousedown()}}(this),50)}else if(!this.active_field)return this.activate_field()};
AbstractChosen.prototype.input_blur=function(evt){if(!this.mouse_on_container){this.active_field=false;return setTimeout(function(_this){return function(){return _this.blur_test()}}(this),100)}};AbstractChosen.prototype.label_click_handler=function(evt){if(this.is_multiple)return this.container_mousedown(evt);else return this.activate_field()};AbstractChosen.prototype.results_option_build=function(options){var content,data,data_content,i,len,ref,shown_results;content="";shown_results=0;ref=this.results_data;
for(i=0,len=ref.length;i<len;i++){data=ref[i];data_content="";if(data.group)data_content=this.result_add_group(data);else data_content=this.result_add_option(data);if(data_content!==""){shown_results++;content+=data_content}if(options!=null?options.first:void 0)if(data.selected&&this.is_multiple)this.choice_build(data);else if(data.selected&&!this.is_multiple)this.single_set_selected_text(this.choice_label(data));if(shown_results>=this.max_shown_results)break}return content};AbstractChosen.prototype.result_add_option=
function(option){var classes,option_el;if(!option.search_match)return"";if(!this.include_option_in_results(option))return"";classes=[];if(!option.disabled&&!(option.selected&&this.is_multiple))classes.push("active-result");if(option.disabled&&!(option.selected&&this.is_multiple))classes.push("disabled-result");if(option.selected)classes.push("result-selected");if(option.group_array_index!=null)classes.push("group-option");if(option.classes!=="")classes.push(option.classes);option_el=document.createElement("li");
option_el.className=classes.join(" ");if(option.style)option_el.style.cssText=option.style;option_el.setAttribute("data-option-array-index",option.array_index);option_el.innerHTML=option.highlighted_html||option.html;if(option.title)option_el.title=option.title;return this.outerHTML(option_el)};AbstractChosen.prototype.result_add_group=function(group){var classes,group_el;if(!(group.search_match||group.group_match))return"";if(!(group.active_options>0))return"";classes=[];classes.push("group-result");
if(group.classes)classes.push(group.classes);group_el=document.createElement("li");group_el.className=classes.join(" ");group_el.innerHTML=group.highlighted_html||this.escape_html(group.label);if(group.title)group_el.title=group.title;return this.outerHTML(group_el)};AbstractChosen.prototype.results_update_field=function(){this.set_default_text();if(!this.is_multiple)this.results_reset_cleanup();this.result_clear_highlight();this.results_build();if(this.results_showing)return this.winnow_results()};
AbstractChosen.prototype.reset_single_select_options=function(){var i,len,ref,result,results1;ref=this.results_data;results1=[];for(i=0,len=ref.length;i<len;i++){result=ref[i];if(result.selected)results1.push(result.selected=false);else results1.push(void 0)}return results1};AbstractChosen.prototype.results_toggle=function(){if(this.results_showing)return this.results_hide();else return this.results_show()};AbstractChosen.prototype.results_search=function(evt){if(this.results_showing)return this.winnow_results();
else return this.results_show()};AbstractChosen.prototype.winnow_results=function(options){var escapedQuery,fix,i,len,option,prefix,query,ref,regex,results,results_group,search_match,startpos,suffix,text;this.no_results_clear();results=0;query=this.get_search_text();escapedQuery=query.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");regex=this.get_search_regex(escapedQuery);ref=this.results_data;for(i=0,len=ref.length;i<len;i++){option=ref[i];option.search_match=false;results_group=null;search_match=null;
option.highlighted_html="";if(this.include_option_in_results(option)){if(option.group){option.group_match=false;option.active_options=0}if(option.group_array_index!=null&&this.results_data[option.group_array_index]){results_group=this.results_data[option.group_array_index];if(results_group.active_options===0&&results_group.search_match)results+=1;results_group.active_options+=1}text=option.group?option.label:option.text;if(!(option.group&&!this.group_search)){search_match=this.search_string_match(text,
regex);option.search_match=search_match!=null;if(option.search_match&&!option.group)results+=1;if(option.search_match){if(query.length){startpos=search_match.index;prefix=text.slice(0,startpos);fix=text.slice(startpos,startpos+query.length);suffix=text.slice(startpos+query.length);option.highlighted_html=this.escape_html(prefix)+"<em>"+this.escape_html(fix)+"</em>"+this.escape_html(suffix)}if(results_group!=null)results_group.group_match=true}else if(option.group_array_index!=null&&this.results_data[option.group_array_index].search_match)option.search_match=
true}}}this.result_clear_highlight();if(results<1&&query.length){this.update_results_content("");return this.no_results(query)}else{this.update_results_content(this.results_option_build());if(!(options!=null?options.skip_highlight:void 0))return this.winnow_results_set_highlight()}};AbstractChosen.prototype.get_search_regex=function(escaped_search_string){var regex_flag,regex_string;regex_string=this.search_contains?escaped_search_string:"(^|\\s|\\b)"+escaped_search_string+"[^\\s]*";if(!(this.enable_split_word_search||
this.search_contains))regex_string="^"+regex_string;regex_flag=this.case_sensitive_search?"":"i";return new RegExp(regex_string,regex_flag)};AbstractChosen.prototype.search_string_match=function(search_string,regex){var match;match=regex.exec(search_string);if(!this.search_contains&&(match!=null?match[1]:void 0))match.index+=1;return match};AbstractChosen.prototype.choices_count=function(){var i,len,option,ref;if(this.selected_option_count!=null)return this.selected_option_count;this.selected_option_count=
0;ref=this.form_field.options;for(i=0,len=ref.length;i<len;i++){option=ref[i];if(option.selected)this.selected_option_count+=1}return this.selected_option_count};AbstractChosen.prototype.choices_click=function(evt){evt.preventDefault();this.activate_field();if(!(this.results_showing||this.is_disabled))return this.results_show()};AbstractChosen.prototype.keydown_checker=function(evt){var ref,stroke;stroke=(ref=evt.which)!=null?ref:evt.keyCode;this.search_field_scale();if(stroke!==8&&this.pending_backstroke)this.clear_backstroke();
switch(stroke){case 8:this.backstroke_length=this.get_search_field_value().length;break;case 9:if(this.results_showing&&!this.is_multiple)this.result_select(evt);this.mouse_on_container=false;break;case 13:if(this.results_showing)evt.preventDefault();break;case 27:if(this.results_showing)evt.preventDefault();break;case 32:if(this.disable_search)evt.preventDefault();break;case 38:evt.preventDefault();this.keyup_arrow();break;case 40:evt.preventDefault();this.keydown_arrow();break}};AbstractChosen.prototype.keyup_checker=
function(evt){var ref,stroke;stroke=(ref=evt.which)!=null?ref:evt.keyCode;this.search_field_scale();switch(stroke){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0)this.keydown_backstroke();else if(!this.pending_backstroke){this.result_clear_highlight();this.results_search()}break;case 13:evt.preventDefault();if(this.results_showing)this.result_select(evt);break;case 27:if(this.results_showing)this.results_hide();break;case 9:case 16:case 17:case 18:case 38:case 40:case 91:break;
default:this.results_search();break}};AbstractChosen.prototype.clipboard_event_checker=function(evt){if(this.is_disabled)return;return setTimeout(function(_this){return function(){return _this.results_search()}}(this),50)};AbstractChosen.prototype.container_width=function(){if(this.options.width!=null)return this.options.width;else return this.form_field.offsetWidth+"px"};AbstractChosen.prototype.include_option_in_results=function(option){if(this.is_multiple&&(!this.display_selected_options&&option.selected))return false;
if(!this.display_disabled_options&&option.disabled)return false;if(option.empty)return false;return true};AbstractChosen.prototype.search_results_touchstart=function(evt){this.touch_started=true;return this.search_results_mouseover(evt)};AbstractChosen.prototype.search_results_touchmove=function(evt){this.touch_started=false;return this.search_results_mouseout(evt)};AbstractChosen.prototype.search_results_touchend=function(evt){if(this.touch_started)return this.search_results_mouseup(evt)};AbstractChosen.prototype.outerHTML=
function(element){var tmp;if(element.outerHTML)return element.outerHTML;tmp=document.createElement("div");tmp.appendChild(element);return tmp.innerHTML};AbstractChosen.prototype.get_single_html=function(){return'<a class="chosen-single chosen-default">\n  <span>'+this.default_text+'</span>\n  <div><b></b></div>\n</a>\n<div class="chosen-drop">\n  <div class="chosen-search">\n    <input class="chosen-search-input" type="text" autocomplete="off" />\n  </div>\n  <ul class="chosen-results"></ul>\n</div>'};
AbstractChosen.prototype.get_multi_html=function(){return'<ul class="chosen-choices">\n  <li class="search-field">\n    <input class="chosen-search-input" type="text" autocomplete="off" value="'+this.default_text+'" />\n  </li>\n</ul>\n<div class="chosen-drop">\n  <ul class="chosen-results"></ul>\n</div>'};AbstractChosen.prototype.get_no_results_html=function(terms){return'<li class="no-results">\n  '+this.results_none_found+" <span>"+this.escape_html(terms)+"</span>\n</li>"};AbstractChosen.browser_is_supported=
function(){if("Microsoft Internet Explorer"===window.navigator.appName)return document.documentMode>=8;if(/iP(od|hone)/i.test(window.navigator.userAgent)||/Windows Phone/i.test(window.navigator.userAgent)||/Android.*Mobile/i.test(window.navigator.userAgent))return true;else if(/IEMobile/i.test(window.navigator.userAgent)||/BlackBerry/i.test(window.navigator.userAgent)||/BB10/i.test(window.navigator.userAgent))return false;return true};AbstractChosen.default_multiple_text="Select Some Options";AbstractChosen.default_single_text=
"Select an Option";AbstractChosen.default_no_result_text="No results match";return AbstractChosen}();$=jQuery;$.fn.extend({chosen:function(options){if(!AbstractChosen.browser_is_supported())return this;return this.each(function(input_field){var $this,chosen;$this=$(this);chosen=$this.data("chosen");if(options==="destroy"){if(chosen instanceof Chosen)chosen.destroy();return}if(!(chosen instanceof Chosen))$this.data("chosen",new Chosen(this,options))})}});Chosen=function(superClass){extend(Chosen,superClass);
function Chosen(){return Chosen.__super__.constructor.apply(this,arguments)}Chosen.prototype.setup=function(){this.form_field_jq=$(this.form_field);return this.current_selectedIndex=this.form_field.selectedIndex};Chosen.prototype.set_up_html=function(){var container_classes,container_props;container_classes=["chosen-container"];container_classes.push("chosen-container-"+(this.is_multiple?"multi":"single"));if(this.inherit_select_classes&&this.form_field.className)container_classes.push(this.form_field.className);
if(this.is_rtl)container_classes.push("chosen-rtl");container_props={"class":container_classes.join(" "),"title":this.form_field.title};if(this.form_field.id.length)container_props.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen";this.container=$("<div />",container_props);this.container.width(this.container_width());if(this.is_multiple)this.container.html(this.get_multi_html());else this.container.html(this.get_single_html());this.form_field_jq.hide().after(this.container);this.dropdown=this.container.find("div.chosen-drop").first();
this.search_field=this.container.find("input").first();this.search_results=this.container.find("ul.chosen-results").first();this.search_field_scale();this.search_no_results=this.container.find("li.no-results").first();if(this.is_multiple){this.search_choices=this.container.find("ul.chosen-choices").first();this.search_container=this.container.find("li.search-field").first()}else{this.search_container=this.container.find("div.chosen-search").first();this.selected_item=this.container.find(".chosen-single").first()}this.results_build();
this.set_tab_index();return this.set_label_behavior()};Chosen.prototype.on_ready=function(){return this.form_field_jq.trigger("chosen:ready",{chosen:this})};Chosen.prototype.register_observers=function(){this.container.on("touchstart.chosen",function(_this){return function(evt){_this.container_mousedown(evt)}}(this));this.container.on("touchend.chosen",function(_this){return function(evt){_this.container_mouseup(evt)}}(this));this.container.on("mousedown.chosen",function(_this){return function(evt){_this.container_mousedown(evt)}}(this));
this.container.on("mouseup.chosen",function(_this){return function(evt){_this.container_mouseup(evt)}}(this));this.container.on("mouseenter.chosen",function(_this){return function(evt){_this.mouse_enter(evt)}}(this));this.container.on("mouseleave.chosen",function(_this){return function(evt){_this.mouse_leave(evt)}}(this));this.search_results.on("mouseup.chosen",function(_this){return function(evt){_this.search_results_mouseup(evt)}}(this));this.search_results.on("mouseover.chosen",function(_this){return function(evt){_this.search_results_mouseover(evt)}}(this));
this.search_results.on("mouseout.chosen",function(_this){return function(evt){_this.search_results_mouseout(evt)}}(this));this.search_results.on("mousewheel.chosen DOMMouseScroll.chosen",function(_this){return function(evt){_this.search_results_mousewheel(evt)}}(this));this.search_results.on("touchstart.chosen",function(_this){return function(evt){_this.search_results_touchstart(evt)}}(this));this.search_results.on("touchmove.chosen",function(_this){return function(evt){_this.search_results_touchmove(evt)}}(this));
this.search_results.on("touchend.chosen",function(_this){return function(evt){_this.search_results_touchend(evt)}}(this));this.form_field_jq.on("chosen:updated.chosen",function(_this){return function(evt){_this.results_update_field(evt)}}(this));this.form_field_jq.on("chosen:activate.chosen",function(_this){return function(evt){_this.activate_field(evt)}}(this));this.form_field_jq.on("chosen:open.chosen",function(_this){return function(evt){_this.container_mousedown(evt)}}(this));this.form_field_jq.on("chosen:close.chosen",
function(_this){return function(evt){_this.close_field(evt)}}(this));this.search_field.on("blur.chosen",function(_this){return function(evt){_this.input_blur(evt)}}(this));this.search_field.on("keyup.chosen",function(_this){return function(evt){_this.keyup_checker(evt)}}(this));this.search_field.on("keydown.chosen",function(_this){return function(evt){_this.keydown_checker(evt)}}(this));this.search_field.on("focus.chosen",function(_this){return function(evt){_this.input_focus(evt)}}(this));this.search_field.on("cut.chosen",
function(_this){return function(evt){_this.clipboard_event_checker(evt)}}(this));this.search_field.on("paste.chosen",function(_this){return function(evt){_this.clipboard_event_checker(evt)}}(this));if(this.is_multiple)return this.search_choices.on("click.chosen",function(_this){return function(evt){_this.choices_click(evt)}}(this));else return this.container.on("click.chosen",function(evt){evt.preventDefault()})};Chosen.prototype.destroy=function(){$(this.container[0].ownerDocument).off("click.chosen",
this.click_test_action);if(this.form_field_label.length>0)this.form_field_label.off("click.chosen");if(this.search_field[0].tabIndex)this.form_field_jq[0].tabIndex=this.search_field[0].tabIndex;this.container.remove();this.form_field_jq.removeData("chosen");return this.form_field_jq.show()};Chosen.prototype.search_field_disabled=function(){this.is_disabled=this.form_field.disabled||this.form_field_jq.parents("fieldset").is(":disabled");this.container.toggleClass("chosen-disabled",this.is_disabled);
this.search_field[0].disabled=this.is_disabled;if(!this.is_multiple)this.selected_item.off("focus.chosen",this.activate_field);if(this.is_disabled)return this.close_field();else if(!this.is_multiple)return this.selected_item.on("focus.chosen",this.activate_field)};Chosen.prototype.container_mousedown=function(evt){var ref;if(this.is_disabled)return;if(this.is_multiple){if(evt&&(ref=evt.type)==="mousedown"&&!this.results_showing)evt.preventDefault()}else if(evt&&((ref=evt.type)==="mousedown"||ref===
"touchstart")&&!this.results_showing)evt.preventDefault();if(!(evt!=null&&$(evt.target).hasClass("search-choice-close"))){if(!this.active_field){if(this.is_multiple)this.search_field.val("");$(this.container[0].ownerDocument).on("click.chosen",this.click_test_action);this.results_show()}else if(!this.is_multiple&&evt&&($(evt.target)[0]===this.selected_item[0]||$(evt.target).parents("a.chosen-single").length)){evt.preventDefault();this.results_toggle()}return this.activate_field()}};Chosen.prototype.container_mouseup=
function(evt){if(evt.target.nodeName==="ABBR"&&!this.is_disabled)return this.results_reset(evt)};Chosen.prototype.search_results_mousewheel=function(evt){var delta;if(evt.originalEvent)delta=evt.originalEvent.deltaY||-evt.originalEvent.wheelDelta||evt.originalEvent.detail;if(delta!=null){evt.preventDefault();if(evt.type==="DOMMouseScroll")delta=delta*40;return this.search_results.scrollTop(delta+this.search_results.scrollTop())}};Chosen.prototype.blur_test=function(evt){if(!this.active_field&&this.container.hasClass("chosen-container-active"))return this.close_field()};
Chosen.prototype.close_field=function(){$(this.container[0].ownerDocument).off("click.chosen",this.click_test_action);this.active_field=false;this.results_hide();this.container.removeClass("chosen-container-active");this.clear_backstroke();this.show_search_field_default();this.search_field_scale();return this.search_field.blur()};Chosen.prototype.activate_field=function(){if(this.is_disabled)return;this.container.addClass("chosen-container-active");this.active_field=true;this.search_field.val(this.search_field.val());
return this.search_field.focus()};Chosen.prototype.test_active_click=function(evt){var active_container;active_container=$(evt.target).closest(".chosen-container");if(active_container.length&&this.container[0]===active_container[0])return this.active_field=true;else return this.close_field()};Chosen.prototype.results_build=function(){this.parsing=true;this.selected_option_count=null;this.results_data=SelectParser.select_to_array(this.form_field);if(this.is_multiple)this.search_choices.find("li.search-choice").remove();
else{this.single_set_selected_text();if(this.disable_search||this.form_field.options.length<=this.disable_search_threshold){this.search_field[0].readOnly=true;this.container.addClass("chosen-container-single-nosearch")}else{this.search_field[0].readOnly=false;this.container.removeClass("chosen-container-single-nosearch")}}this.update_results_content(this.results_option_build({first:true}));this.search_field_disabled();this.show_search_field_default();this.search_field_scale();return this.parsing=
false};Chosen.prototype.result_do_highlight=function(el){var high_bottom,high_top,maxHeight,visible_bottom,visible_top;if(el.length){this.result_clear_highlight();this.result_highlight=el;this.result_highlight.addClass("highlighted");maxHeight=parseInt(this.search_results.css("maxHeight"),10);visible_top=this.search_results.scrollTop();visible_bottom=maxHeight+visible_top;high_top=this.result_highlight.position().top+this.search_results.scrollTop();high_bottom=high_top+this.result_highlight.outerHeight();
if(high_bottom>=visible_bottom)return this.search_results.scrollTop(high_bottom-maxHeight>0?high_bottom-maxHeight:0);else if(high_top<visible_top)return this.search_results.scrollTop(high_top)}};Chosen.prototype.result_clear_highlight=function(){if(this.result_highlight)this.result_highlight.removeClass("highlighted");return this.result_highlight=null};Chosen.prototype.results_show=function(){if(this.is_multiple&&this.max_selected_options<=this.choices_count()){this.form_field_jq.trigger("chosen:maxselected",
{chosen:this});return false}this.container.addClass("chosen-with-drop");this.results_showing=true;this.search_field.focus();this.search_field.val(this.get_search_field_value());this.winnow_results();return this.form_field_jq.trigger("chosen:showing_dropdown",{chosen:this})};Chosen.prototype.update_results_content=function(content){return this.search_results.html(content)};Chosen.prototype.results_hide=function(){if(this.results_showing){this.result_clear_highlight();this.container.removeClass("chosen-with-drop");
this.form_field_jq.trigger("chosen:hiding_dropdown",{chosen:this})}return this.results_showing=false};Chosen.prototype.set_tab_index=function(el){var ti;if(this.form_field.tabIndex){ti=this.form_field.tabIndex;this.form_field.tabIndex=-1;return this.search_field[0].tabIndex=ti}};Chosen.prototype.set_label_behavior=function(){this.form_field_label=this.form_field_jq.parents("label");if(!this.form_field_label.length&&this.form_field.id.length)this.form_field_label=$("label[for='"+this.form_field.id+
"']");if(this.form_field_label.length>0)return this.form_field_label.on("click.chosen",this.label_click_handler)};Chosen.prototype.show_search_field_default=function(){if(this.is_multiple&&this.choices_count()<1&&!this.active_field){this.search_field.val(this.default_text);return this.search_field.addClass("default")}else{this.search_field.val("");return this.search_field.removeClass("default")}};Chosen.prototype.search_results_mouseup=function(evt){var target;target=$(evt.target).hasClass("active-result")?
$(evt.target):$(evt.target).parents(".active-result").first();if(target.length){this.result_highlight=target;this.result_select(evt);return this.search_field.focus()}};Chosen.prototype.search_results_mouseover=function(evt){var target;target=$(evt.target).hasClass("active-result")?$(evt.target):$(evt.target).parents(".active-result").first();if(target)return this.result_do_highlight(target)};Chosen.prototype.search_results_mouseout=function(evt){if($(evt.target).hasClass("active-result")||$(evt.target).parents(".active-result").first())return this.result_clear_highlight()};
Chosen.prototype.choice_build=function(item){var choice,close_link;choice=$("<li />",{"class":"search-choice"}).html("<span>"+this.choice_label(item)+"</span>");if(item.disabled)choice.addClass("search-choice-disabled");else{close_link=$("<a />",{"class":"search-choice-close","data-option-array-index":item.array_index});close_link.on("click.chosen",function(_this){return function(evt){return _this.choice_destroy_link_click(evt)}}(this));choice.append(close_link)}return this.search_container.before(choice)};
Chosen.prototype.choice_destroy_link_click=function(evt){evt.preventDefault();evt.stopPropagation();if(!this.is_disabled)return this.choice_destroy($(evt.target))};Chosen.prototype.choice_destroy=function(link){if(this.result_deselect(link[0].getAttribute("data-option-array-index"))){if(this.active_field)this.search_field.focus();else this.show_search_field_default();if(this.is_multiple&&this.choices_count()>0&&this.get_search_field_value().length<1)this.results_hide();link.parents("li").first().remove();
return this.search_field_scale()}};Chosen.prototype.results_reset=function(){this.reset_single_select_options();this.form_field.options[0].selected=true;this.single_set_selected_text();this.show_search_field_default();this.results_reset_cleanup();this.trigger_form_field_change();if(this.active_field)return this.results_hide()};Chosen.prototype.results_reset_cleanup=function(){this.current_selectedIndex=this.form_field.selectedIndex;return this.selected_item.find("abbr").remove()};Chosen.prototype.result_select=
function(evt){var high,item;if(this.result_highlight){high=this.result_highlight;this.result_clear_highlight();if(this.is_multiple&&this.max_selected_options<=this.choices_count()){this.form_field_jq.trigger("chosen:maxselected",{chosen:this});return false}if(this.is_multiple)high.removeClass("active-result");else this.reset_single_select_options();high.addClass("result-selected");item=this.results_data[high[0].getAttribute("data-option-array-index")];item.selected=true;this.form_field.options[item.options_index].selected=
true;this.selected_option_count=null;if(this.is_multiple)this.choice_build(item);else this.single_set_selected_text(this.choice_label(item));if(this.is_multiple&&(!this.hide_results_on_select||(evt.metaKey||evt.ctrlKey)))if(evt.metaKey||evt.ctrlKey)this.winnow_results({skip_highlight:true});else{this.search_field.val("");this.winnow_results()}else{this.results_hide();this.show_search_field_default()}if(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex)this.trigger_form_field_change({selected:this.form_field.options[item.options_index].value});
this.current_selectedIndex=this.form_field.selectedIndex;evt.preventDefault();return this.search_field_scale()}};Chosen.prototype.single_set_selected_text=function(text){if(text==null)text=this.default_text;if(text===this.default_text)this.selected_item.addClass("chosen-default");else{this.single_deselect_control_build();this.selected_item.removeClass("chosen-default")}return this.selected_item.find("span").html(text)};Chosen.prototype.result_deselect=function(pos){var result_data;result_data=this.results_data[pos];
if(!this.form_field.options[result_data.options_index].disabled){result_data.selected=false;this.form_field.options[result_data.options_index].selected=false;this.selected_option_count=null;this.result_clear_highlight();if(this.results_showing)this.winnow_results();this.trigger_form_field_change({deselected:this.form_field.options[result_data.options_index].value});this.search_field_scale();return true}else return false};Chosen.prototype.single_deselect_control_build=function(){if(!this.allow_single_deselect)return;
if(!this.selected_item.find("abbr").length)this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>');return this.selected_item.addClass("chosen-single-with-deselect")};Chosen.prototype.get_search_field_value=function(){return this.search_field.val()};Chosen.prototype.get_search_text=function(){return $.trim(this.get_search_field_value())};Chosen.prototype.escape_html=function(text){return $("<div/>").text(text).html()};Chosen.prototype.winnow_results_set_highlight=
function(){var do_high,selected_results;selected_results=!this.is_multiple?this.search_results.find(".result-selected.active-result"):[];do_high=selected_results.length?selected_results.first():this.search_results.find(".active-result").first();if(do_high!=null)return this.result_do_highlight(do_high)};Chosen.prototype.no_results=function(terms){var no_results_html;no_results_html=this.get_no_results_html(terms);this.search_results.append(no_results_html);return this.form_field_jq.trigger("chosen:no_results",
{chosen:this})};Chosen.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()};Chosen.prototype.keydown_arrow=function(){var next_sib;if(this.results_showing&&this.result_highlight){next_sib=this.result_highlight.nextAll("li.active-result").first();if(next_sib)return this.result_do_highlight(next_sib)}else return this.results_show()};Chosen.prototype.keyup_arrow=function(){var prev_sibs;if(!this.results_showing&&!this.is_multiple)return this.results_show();else if(this.result_highlight){prev_sibs=
this.result_highlight.prevAll("li.active-result");if(prev_sibs.length)return this.result_do_highlight(prev_sibs.first());else{if(this.choices_count()>0)this.results_hide();return this.result_clear_highlight()}}};Chosen.prototype.keydown_backstroke=function(){var next_available_destroy;if(this.pending_backstroke){this.choice_destroy(this.pending_backstroke.find("a").first());return this.clear_backstroke()}else{next_available_destroy=this.search_container.siblings("li.search-choice").last();if(next_available_destroy.length&&
!next_available_destroy.hasClass("search-choice-disabled")){this.pending_backstroke=next_available_destroy;if(this.single_backstroke_delete)return this.keydown_backstroke();else return this.pending_backstroke.addClass("search-choice-focus")}}};Chosen.prototype.clear_backstroke=function(){if(this.pending_backstroke)this.pending_backstroke.removeClass("search-choice-focus");return this.pending_backstroke=null};Chosen.prototype.search_field_scale=function(){var div,i,len,style,style_block,styles,width;
if(!this.is_multiple)return;style_block={position:"absolute",left:"-1000px",top:"-1000px",display:"none",whiteSpace:"pre"};styles=["fontSize","fontStyle","fontWeight","fontFamily","lineHeight","textTransform","letterSpacing"];for(i=0,len=styles.length;i<len;i++){style=styles[i];style_block[style]=this.search_field.css(style)}div=$("<div />").css(style_block);div.text(this.get_search_field_value());$("body").append(div);width=div.width()+25;div.remove();if(this.container.is(":visible"))width=Math.min(this.container.outerWidth()-
10,width);return this.search_field.width(width)};Chosen.prototype.trigger_form_field_change=function(extra){this.form_field_jq.trigger("input",extra);return this.form_field_jq.trigger("change",extra)};return Chosen}(AbstractChosen)}).call(this);function faq_expand_tag(){$(".card-header .btn").click(function(){var answer_id=$(this).attr("data-target");var faq_id=$(this).attr("faq_id");setTimeout(function(){if($(answer_id).hasClass("show"))if(typeof dataLayer!=="undefined"){dataLayer.push({"event":"help_center_click_event","eventCategory":"help_center_section","eventAction":"click","eventLabel":faq_id});dataLayer.push({"event":"help_center_click","click":"section_"+faq_id})}},500)})}
function query_form(help_center_role){$("#query_form").validate({ignore:"",onfocusout:function(element){this.element(element)},rules:{email:{required:true,email:true,maxlength:100},name:{required:true,user_name:true,maxlength:100},query_subject:{required:true},query_data:{required:function(elm){if(help_center_role==="employer"){var select_query_id=$("#query_subject").find("option:checked").val();return![15].includes(Number(select_query_id))}else return true},maxlength:2048,minlength:function(){var select_query_id=
$("#query_subject").find("option:checked").val();if(select_query_id==15)return 0;else return 50}},query_job_selection:{required:function(elm){if(help_center_role==="employer"){var subject_query_id=$("#query_subject").find("option:checked").val();return employer_help_center_subject_ids.includes(Number(subject_query_id))}else return false}},query_internship:{required:function(elm){if(help_center_role==="student"){internship_query_id=$("#query_subject").find("option:checked").val();return internship_query_ids.includes(Number(internship_query_id))}else return false}},
"query_sub_category_internship[]":{required:function(elm){if(help_center_role==="student"){var employment_type;if(window.is_on_chat_page){employment_type=$("#query_internship").attr("employment_type");internship_query_id=$("#query_subject").val()}else{employment_type=$("#query_internship").find(":selected").attr("employment_type");internship_query_id=$("#query_subject").find("option:checked").val();if(!employment_type)employment_type="internship"}return employment_type=="internship"&&internship_query_id==
query_box_id}else return false}},"query_sub_category_job[]":{required:function(elm){if(help_center_role==="student"){var employment_type;if(window.is_on_chat_page){employment_type=$("#query_internship").attr("employment_type");internship_query_id=$("#query_subject").val()}else{employment_type=$("#query_internship").find(":selected").attr("employment_type");internship_query_id=$("#query_subject").find("option:checked").val()}return employment_type=="job"&&internship_query_id==query_box_id}else return false}},
"attachments[]":{extension:"jpg,jpeg,png,gif,bmp,pdf,JPG,JPEG,PNG,GIF,BMP,PDF",size:10}},messages:{query_data:{minlength:jQuery.validator.format("Enter at least {0} characters to proceed.")}},errorPlacement:function(label,element){if(element.attr("name")==="query_subject")label.appendTo("#query_subject_error");else if(element.attr("name")==="query_job_selection")label.appendTo("#query_job_selection_error");else if(element.attr("name")==="query_internship")label.appendTo("#query_internship_error");
else if(element.attr("name")==="query_sub_category_internship[]")label.appendTo("#query_subcategory_error");else if(element.attr("name")==="query_sub_category_job[]")label.appendTo("#query_subcategory_error");else if(element.attr("name")==="attachments[]")label.appendTo("#attachments_error");else label.insertAfter(element)},highlight:function(label){$(label).closest(".form-group").addClass("has-error");$(label).closest(".form-group").removeClass("has-success");$(label).closest("input").addClass("error");
$(label).closest("input").removeClass("valid")},success:function(label){$(label).closest(".form-group").addClass("has-success");$(label).closest(".form-group").removeClass("has-error");$(label).closest("input").addClass("valid");$(label).closest("input").removeClass("error")},submitHandler:function(){if(total_size>5E3){$("#attachments_error").html("Attachment failed. Total files size allowed is 5 MB.");return false}if(total_attachments>max_attachments){$("#attachments_error").html("Attachment failed. You can only upload maximum 10 attachments.");
return false}var form=document.querySelector("#query_form");var form_data=new FormData(form);form_data["delete"]("attachments[]");for(var i=0,len=attachments.length;i<len;i++)form_data.append("attachments[]",attachments[i].file);var url="/"+help_center_role+"/query_box_submit";if(!window.is_on_chat_page&&help_center_role==="student"&&total_attachments===0)show_attachment_alert_modal(url,form_data);else{$.ajax(url,{data:form_data,success:query_success,error:onError,type:"POST",processData:false,contentType:false});
NProgress.start();$(".loading_image").show()}return false}})}
function show_attachment_alert_modal(url,form_data){$(".loading_image").hide();$("#alert_modal .text-heading").hide();$("#alert_modal .text-message").html("It seems like you have not attached any screenshots regarding the issue. Do you want to send anyway?");$("#alert_modal .modal_primary_btn").text("Send");if($("#alert_modal .modal_secondary_btn").length===0)$("#alert_modal .button_container").prepend('<button class="btn btn-secondary modal_secondary_btn close_action" data-dismiss="modal">Cancel</button>');$("#alert_modal .modal_primary_btn").addClass("close_action");
$("#alert_modal .modal_primary_btn").removeAttr("href");$("#alert_modal .modal_primary_btn").attr("data-dismiss","modal");$("#alert_modal .modal_primary_btn").off("click").click(function(){$.ajax(url,{data:form_data,success:query_success,error:onError,type:"POST",processData:false,contentType:false});NProgress.start();$(".loading_image").show()});$("#alert_modal").removeData("bs.modal").modal({show:true,backdrop:"true",keyboard:true})}
function show_attachment_error(error_massage){$("#attachments_error").html(error_massage);$("#attachment").val("");return false}
function query_subject(help_center_role){$("#query_subject").change(function(){if(mainRole===help_center_role||!$("#query_subject").val()||$("#query_subject").find("option:checked").text()==="Others"){$("#query_data").show();$("#query_data_logged_out").hide();$("#query_data_logged_out a").attr("href","/"+help_center_role+"/help_center_faq/"+query_box_id)}else{$("#query_data").val("");$("#query_data").hide();$("#query_data_logged_out").show();if(typeof query_box_id!="undefined")if($(this).val())$("#query_data_logged_out a").attr("href",
"/"+help_center_role+"/help_center_faq/"+query_box_id+"/"+$(this).val());else $("#query_data_logged_out a").attr("href","/"+help_center_role+"/help_center_faq/"+query_box_id);else $("#query_data_logged_out a").attr("href","/"+help_center_role+"/help_center_faq/");$("#query_data").closest(".form-control").removeClass("error");$("#query_data").closest(".form-control").removeClass("valid");$("#query_data").closest(".form-group").removeClass("has-error");$("#query_data").closest(".form-group").removeClass("has-success");
$("#query_data-error").remove()}if(help_center_role=="employer"){$("#query_data").attr("placeholder",query_box_placeholders[$("#query_subject").val()]);if(mainRole===help_center_role)job_selection_drop_down()}if(help_center_role=="student"){internship_query_id=$("#query_subject").find("option:checked").val();if(mainRole===help_center_role&&internship_query_ids.includes(Number(internship_query_id)))$("#query_internship_container").show();else $("#query_internship_container").hide()}})}
function load_accordions(type){$("#category_container .nav-item").click(function(){var heading_element=$(this).find(".category_heading");if(!heading_element.hasClass("active")){var category_content_to_activate=heading_element.attr("data-id");if(typeof dataLayer!=="undefined"){dataLayer.push({"event":"help_center_click_event","eventCategory":"help_center_catgory","eventAction":"click","eventLabel":category_content_to_activate});dataLayer.push({"event":"help_center_click","click":"category_"+category_content_to_activate})}$(".category_heading").removeClass("active");
heading_element.addClass("active");$(".faq_category_content.active_category").fadeOut("",function(){close_accordion_section();$(".faq_category_content").removeClass("active_category");$("#breadcrumb_active_category").html(heading_element.attr("data-name"));history.replaceState("","","/"+type+"/help_center_faq/"+category_content_to_activate);$("#category_content_"+category_content_to_activate).fadeIn().addClass("active_category")})}})}
function scroll_tabs(){if($("#category_container .nav-item .active").is(":visible")){var heading_scroll_position=$("#category_container .nav-item .active").offset().left+$("#category_container .nav-item .active").outerWidth(true)/2+$("#category_container").scrollLeft()-$("#category_container").width()/2;$("#category_container .vertical_reverse").scrollLeft(heading_scroll_position)}}function close_accordion_section(){$(".card-header .btn").addClass("collapsed");$(".answer").removeClass("show")}
function query_remove_attachment(){$(document).on("click",".delete_attachment",function(){var attachment_id=$(this).attr("data-id");for(var i=0;i<attachments.length;++i)if(attachments[i].id===attachment_id){if(total_size>1){var size=attachments[i].file.size/1024;size=Math.round(size*100)/100;total_size=total_size-size}if(total_attachments>=1)total_attachments--;attachments.splice(i,1)}$(this).parent("#"+attachment_id).remove();if(total_size<5E3||total_attachments<max_attachments)$("#attachments_error").html("")})}
function query_attachment(){$("#attachment").change(function(e){$("#attachments_error").html("");if(this.files&&this.files.length)for(var x=0;x<this.files.length;x++){var name=this.files[x].name;var size=this.files[x].size/1024;size=Math.round(size*100)/100;if(total_size+size>5E3)return show_attachment_error("Attachment failed. Total files size allowed is 5 MB.");if(total_attachments>=max_attachments)return show_attachment_error("Attachment failed. You can only upload maximum 10 attachments.");var extension=
this.files[x].name.replace(/^.*\./,"");extension=extension.toLowerCase();var file_type="";var type="doc";switch(extension){case "png":case "jpg":case "jpeg":case "gif":case "bmp":file_type=extension.toUpperCase();type="image";break;case "pdf":file_type=extension.toUpperCase();break;default:return show_attachment_error("Please upload a file with a valid extension.")}var date=new Date;var attachment='<div class="attachment" id="attachment_'+date.getTime()+'" title="'+name+'">'+'   <div class="attachment_icon '+
type+'">'+file_type+"</div>"+'   <div class="attachment_text">'+'       <span class="attachment_name">'+name.replace("."+extension,"").slice(0,19)+(name.length>19?"....":".")+extension+"</span>"+"       <br>"+'       <span class="attachment_size">'+size+" KB</span>"+"   </div>"+'   <img class="delete_attachment" data-id="attachment_'+date.getTime()+'" src="/static/images/help_center/attachment_cross_icon.svg">'+"</div>";$("#uploaded_attachments").append(attachment);attachments.push({id:"attachment_"+
date.getTime(),file:this.files[x]});total_size=total_size+size;total_attachments++;attachment=""}})};var total_size=0;var total_attachments=0;var max_attachments=10;var attachments=[];var is_open=false;var is_chosen_change=false;$(document).ready(function(){$(".chosen-select").chosen();scroll_tabs();load_accordions("student");query_box();faq_expand_tag();init_sub_category();handle_sub_category()});
function query_box(){query_subject("student");query_form("student");query_attachment();query_remove_attachment();internship_issue_helper_text();$("#query_subject").change(function(){internship_issue_helper_text()})}function internship_issue_helper_text(){if(mainRole==="student"&&$("#query_subject").find("option:checked").val()==8)$(".internship_issue_helper_text").show();else $(".internship_issue_helper_text").hide()}
var query_success=function(data){try{NProgress.done();total_size=0;total_attachments=0;attachments.length=0;$("#uploaded_attachments").html("");if(data.success){if(window.is_on_chat_page)$("#query_modal").modal("hide");reset_form_validations("query_form");$("#query_form")[0].reset();if(!window.is_on_chat_page){internship_query_id=$("#query_subject").find("option:checked").val();$("#query_subject").val("").trigger("chosen:updated");if(mainRole==="student"&&internship_query_ids.includes(Number(internship_query_id))){$("#query_internship_container").show();
$(".chosen-select").chosen()}else $("#query_internship_container").hide()}$("#attachments_error").html("");$("#query_sub_category_container").hide();$("#query_internship").val("").trigger("chosen:updated");clear_sub_category_tags();if(window.is_on_chat_page){var conversation_id=$("#help_center_form_chat_conversation_id").val();Chat.onJobReportSuccessInReact({conversationId:conversation_id,blockedSuccess:data.blocked_success})}if(data.successHeading)success_modal(data.successMsg,null,data.buttonValue,
data.successHeading,true);else throw_success(data.successMsg)}else throw_error(data.errorThrown)}catch(e){throw_error(e);NProgress.done();$(".loading_image").hide()}};
$("#query_data_logged_out a").click(function(e){if(mainRole!=="guest")return;if(window.location.host!==this.host)return;e.preventDefault();$(".google_login").attr("href","/login/get_google/student/"+encodeURIComponent(this.pathname));loginModalSuccessPage="/"+encodeURIComponent(this.pathname);$("#login-modal").modal("show");var email=$("#query_form #email").val();if(email)$("#modal-login-form #modal_email").val(email)});
function init_sub_category(){$("#query_sub_category_container .chosen-container").addClass("carot-down");$(".chosen-subcategory").chosen().change(function(){if($("#query_sub_category_container .chosen-container").hasClass("chosen-container-active")){$("#query_sub_category_container .chosen-container").removeClass("chosen-container-active");$("#query_sub_category_container .chosen-container").removeClass("chosen-with-drop");$("#query_sub_category_container .chosen-search-input").attr("placeholder",
"Choose from dropdown");is_chosen_change=true}else $(".chosen-subcategory").trigger("chosen:close");is_open=false;$("#query_sub_category_container .chosen-container").removeClass("carot-up");$("#query_sub_category_container .chosen-container").addClass("carot-down")});if(!$("#query_sub_category_internship_chosen").hasClass("values_outside"))$("#query_sub_category_internship_chosen").addClass("values_outside");if(!$("#query_sub_category_job_chosen").hasClass("values_outside"))$("#query_sub_category_job_chosen").addClass("values_outside");
if(mainRole==="student"&&$("#query_subject").find("option:checked").val()==query_box_id){$("#query_sub_category_container").show();$("#query_sub_category_internship_container").show();$("#query_sub_category_job_container").hide()}else{$("#query_sub_category_container").hide();$("#query_sub_category_internship_container").hide();$("#query_sub_category_job_container").hide()}$("#query_sub_category_container .chosen-search-input").attr("readonly","true")}
function handle_sub_category(){$("#query_subject").change(function(){if(mainRole==="student"&&$("#query_subject").find("option:checked").val()==query_box_id){$("#query_sub_category_container").show();$("#query_sub_category_internship_container").show();$("#query_sub_category_job_container").hide()}else{$("#query_sub_category_container").hide();$("#query_sub_category_internship_container").hide();$("#query_sub_category_job_container").hide();clear_sub_category_tags()}$("#query_sub_category_container .chosen-search-input").attr("readonly",
"true")});$("#query_internship").change(function(){var employment_type=$("#query_internship").find(":selected").attr("employment_type");var checked_query_box_id=$("#query_subject").find("option:checked").val();if(checked_query_box_id==query_box_id)if(employment_type=="internship"){$("#query_sub_category_internship_container").show();$("#query_sub_category_job_container").hide()}else{$("#query_sub_category_internship_container").hide();$("#query_sub_category_job_container").show()}clear_sub_category_tags();
$("#query_sub_category_container .chosen-search-input").attr("readonly","true")});$("#query_sub_category_container .chosen-search-input").click(function(e){if(is_open==false){$("#query_sub_category_container .chosen-search-input").attr("placeholder","");$("#query_sub_category_container .chosen-container").addClass("chosen-container-active");$("#query_sub_category_container .chosen-container").addClass("chosen-with-drop");$("#query_sub_category_container .chosen-container").addClass("carot-up");$("#query_sub_category_container .chosen-container").removeClass("carot-down");
is_open=true}else{$("#query_sub_category_container .chosen-search-input").attr("placeholder","Choose from dropdown");$("#query_sub_category_container .chosen-container").removeClass("chosen-container-active");$("#query_sub_category_container .chosen-container").removeClass("chosen-with-drop");$("#query_sub_category_container .chosen-container").removeClass("carot-up");$("#query_sub_category_container .chosen-container").addClass("carot-down");is_open=false}e.stopPropagation()});$(".chosen-subcategory").on("chosen:hiding_dropdown",
function(){is_open=false;$("#query_sub_category_container .chosen-search-input").attr("placeholder","Choose from dropdown");$("#query_sub_category_container .chosen-container").removeClass("carot-up");$("#query_sub_category_container .chosen-container").addClass("carot-down")});$("#query_sub_category_container ul.chosen-choices").click(function(e){if(is_open==false){$("#query_sub_category_container .chosen-search-input").attr("placeholder","");$("#query_sub_category_container .chosen-container").addClass("chosen-container-active");
$("#query_sub_category_container .chosen-container").addClass("chosen-with-drop");$("#query_sub_category_container .chosen-container").addClass("carot-up");$("#query_sub_category_container .chosen-container").removeClass("carot-down");is_open=true}else{$("#query_sub_category_container .chosen-search-input").attr("placeholder","Choose from dropdown");$("#query_sub_category_container .chosen-container").removeClass("chosen-container-active");$("#query_sub_category_container .chosen-container").removeClass("chosen-with-drop");
$("#query_sub_category_container .chosen-container").removeClass("carot-up");$("#query_sub_category_container .chosen-container").addClass("carot-down");is_open=false}});$("#query_sub_category_container .chosen-search-input").focusout(function(){if(is_chosen_change==true){$("#query_sub_category_container .chosen-search-input").attr("placeholder","Choose from dropdown");$("#query_sub_category_container .chosen-container").removeClass("chosen-container-active");$("#query_sub_category_container .chosen-container").removeClass("chosen-with-drop");
$("#query_sub_category_container .chosen-container").removeClass("carot-up");$("#query_sub_category_container .chosen-container").addClass("carot-down");is_open=false;is_chosen_change=false}})}
function clear_sub_category_tags(){if(mainRole==="student"&&$("#query_subject").find("option:checked").val()==query_box_id){$("#query_sub_category_internship_chosen ul.chosen-choices").find("li").not("li.search-field").remove();$("#query_sub_category_job_chosen ul.chosen-choices").find("li").not("li.search-field").remove()}$("#query_sub_category_internship").val("").trigger("chosen:updated");$("#query_sub_category_job").val("").trigger("chosen:updated")};var scheduled_interview_data;
$(function(){$("#interview_accept_form").validate({onfocusout:function(element){this.element(element)},ignore:"",rules:{message:{required:true,maxlength:2048}},errorPlacement:function(label,element){if(element.parent(".has_char_count").length){var parent=element.parent(".has_char_count");label.insertAfter(parent)}},highlight:function(label){highlight(label)},success:function(label){success(label)},submitHandler:function(){submit("#interview_accept_form")}});$("#interview_decline_form").validate({onfocusout:function(element){this.element(element)},ignore:"",
rules:{message:{required:true,maxlength:2048}},errorPlacement:function(label,element){if(element.parent(".has_char_count").length){var parent=element.parent(".has_char_count");label.insertAfter(parent)}},highlight:function(label){highlight(label)},success:function(label){success(label)},submitHandler:function(){submit("#interview_decline_form")}});$("#interview_reschedule_form").validate({onfocusout:function(element){this.element(element)},ignore:"",rules:{interview_date:{required:true},interview_timing:{required:true},
message:{required:true,maxlength:2048}},highlight:function(label){if(label.name=="interview_date"){$("#interview_datepicker_form_field").addClass("has-error");$("#interview_datepicker_form_field").removeClass("has-success")}if(label.name=="interview_timing"){$("#interview_timing_chosen").addClass("has-error");$("#interview_timing_chosen").removeClass("has-success")}$(label).closest(".form-group").addClass("has-error");$(label).closest(".form-group").removeClass("has-success");$(label).closest("input").addClass("error");
$(label).closest("input").removeClass("valid")},success:function(label){$(label).closest(".form-group").addClass("has-success");$(label).closest(".form-group").removeClass("has-error");$(label).closest("input").addClass("valid");$(label).closest("input").removeClass("error")},errorPlacement:function(label,element){if(element.parent(".has_char_count").length){var parent=element.parent(".has_char_count");label.insertAfter(parent)}else if(element[0].name=="interview_date")$(".interview-calendar-container").append(label);
else if(element.attr("name")==="interview_timing")label.insertAfter(element.siblings(".chosen-container"));else label.insertAfter(element)},submitHandler:function(){submit("#interview_reschedule_form")}});update_interview_time_slot();custom_date_picker1("interview_date","d M'' y");initialize_interview_timing_chosen();$("#interview_timing").on("change",function(){if(this.value){$("#interview_timing_chosen").removeClass("has-error");$("#interview_timing-error").remove()}})});
$("body").on("click",".accept-interview-cta",function(){setTimeout(function(){$("#student_interview_accept_modal").modal("show");var text="";if(window.interview_type==="phone")text=window.accept_modal_message+" I am reachable at "+window.student_country_code+window.student_phone;else text=window.accept_modal_message;$("#student_interview_accept_modal #accept_interview_message").val(text);textarea_char_count()},0)});
$("body").on("click",".cancel-interview-cta",function(){setTimeout(function(){$("#student_interview_decline_modal").modal("show");$("#student_interview_decline_modal #decline_interview_message").val(window.decline_modal_message);textarea_char_count()},0)});
$("body").on("click",".reschedule-interview-cta",function(){setTimeout(function(){$("#student_interview_reschedule_modal").modal("show");$("#student_interview_reschedule_modal #reschedule_interview_message").val(window.reschedule_modal_message);textarea_char_count();var today_date=get_today_date();var application_access_date=new Date(window.application_access_till);var days_difference=Math.trunc((application_access_date.getTime()-today_date.getTime())/(1E3*60*60*24))-1;$("#interview_date").datepicker("option",
"maxDate","+"+days_difference+"d");var selectedDate=get_date_format_for_datepicker(new Date(window.interview_date));var timeSlot=window.interview_start_time+" - "+window.interview_end_time;$("#interview_date").val(selectedDate);$("#interview_date_pseudo .default").hide();$("#interview_date_pseudo .value").show();$("#interview_date_pseudo .value span").html(selectedDate);update_interview_time_slot(timeSlot);$("#submit_btn").prop("disabled",true);watch_reschedule_form_changes(selectedDate,timeSlot)},
0)});function watch_reschedule_form_changes(previousDate,timeSlot){$("#interview_reschedule_form :input").change(function(){if($("#interview_date").val()==previousDate&&$("#interview_timing").val()==timeSlot)$("#submit_btn").prop("disabled",true);else $("#submit_btn").prop("disabled",false)})}
function get_date_format_for_datepicker(date){var day=date.toLocaleDateString("default",{day:"numeric"});var month=date.toLocaleDateString("default",{month:"short"})+"'";var year=date.toLocaleDateString("default",{year:"2-digit"});return day+" "+month+" "+year}function get_today_date(){var today_date=new Date;today_date=today_date.getFullYear()+"-"+("0"+(today_date.getMonth()+1)).slice(-2)+"-"+("0"+today_date.getDate()).slice(-2);today_date=new Date(today_date);return today_date}
function highlight(label){$(label).closest(".form-group").addClass("has-error");$(label).closest(".form-group").removeClass("has-success");$(label).closest("input").addClass("error");$(label).closest("input").removeClass("valid")}function success(label){$(label).closest(".form-group").addClass("has-success");$(label).closest(".form-group").removeClass("has-error");$(label).closest("input").addClass("valid");$(label).closest("input").removeClass("error")}
function submit(formId){if(formId==="#interview_reschedule_form"){var form=document.querySelector(formId);var fd=new FormData(form);fd.append("chat_conversation_id",window.conversation_id);fd.append("message_id",window.message_id);NProgress.start();$.ajax("/chat/reschedule_interview",{data:fd,processData:false,contentType:false,success:reschedule_interview_success,error:onError,type:"POST"})}else{var form=document.querySelector(formId);var fd=new FormData(form);fd.append("chat_conversation_id",window.conversation_id);
fd.append("interview_status",window.interview_status);fd.append("message_id",window.employer_chat_message_id);if(window.interview_type==="phone"){fd.append("student_country_code",window.student_country_code);fd.append("student_phone",window.student_phone)}NProgress.start();$.ajax("/chat/update_interview_status",{data:fd,processData:false,contentType:false,success:interview_reply_success,error:onError,type:"POST"})}return false}
function initialize_interview_timing_chosen(){$("#interview_timing").chosen().on("chosen:showing_dropdown",function(){is_interview_timing_shown_recently=true;$("#interview_timing_chosen .chosen-choices .ic-24-chevron-down").css("display","none");$("#interview_timing_chosen .chosen-choices .ic-24-chevron-up").css("display","block");var a=$("#interview_timing_chosen .chosen-drop ul li.append-icon").prepend("<i class='ic-16-s15-forward'></i>");setTimeout(function(){is_interview_timing_shown_recently=
false},50)}).on("change",function(evt,params){$(this).val("");$(this).trigger("chosen:updated");$(this).val(params.selected);$(this).trigger("chosen:updated");$("#interview_timing_chosen .chosen-choices .ic-24-chevron-down").css("display","block");$("#interview_timing_chosen .chosen-choices .ic-24-chevron-up").css("display","none")});$("#interview_timing_chosen .chosen-choices").append("<i class='ic-24-chevron-down'></i>");$("#interview_timing_chosen .chosen-choices").append("<i class='ic-24-chevron-up'></i>");
$("#interview_timing_chosen .chosen-choices i").css({position:"absolute",right:"12px"});$("#interview_timing_chosen .chosen-choices").css({"padding-right":"36px"});$("#interview_timing_chosen .chosen-choices .ic-24-chevron-up").css("display","none");$("#interview_timing_chosen .chosen-choices .search-field .chosen-search-input").prop("readonly",true);$("#interview_timing_chosen .chosen-choices .ic-24-chevron-up").css("display","none");$("#interview_timing_chosen .chosen-choices .ic-24-chevron-down").on("click",
function(){$("#interview_timing_chosen .chosen-choices .ic-24-chevron-down").css("display","none");$("#interview_timing_chosen .chosen-choices .ic-24-chevron-up").css("display","block")});$("#interview_timing_chosen .chosen-choices .ic-24-chevron-up").on("click",function(){if(!is_interview_timing_shown_recently){$("#interview_timing_chosen .chosen-choices .ic-24-chevron-down").css("display","block");$("#interview_timing_chosen .chosen-choices .ic-24-chevron-up").css("display","none");if($("#interview_timing_chosen .chosen-drop").is(":visible"))setTimeout(function(){$("#interview_timing").chosen().trigger("chosen:close")},
10)}})}
function custom_date_picker1(id,format,div_id){div_id=div_id===undefined?"":div_id;if(!div_id)div_id="interview_date_pseudo";var placeholder=$("#"+id).attr("placeholder");if(!placeholder)placeholder=format;$("#"+id+"_pseudo  .default").html(placeholder);$("#"+id).datepicker({dateFormat:format,minDate:"+0d",maxDate:"+0d",beforeShow:function(textbox,instance){var top=$("#"+id+"_pseudo").offset().top-$(window).scrollTop();setTimeout(function(){instance.dpDiv.css({top:top+40});$("#ui-datepicker-div").innerWidth($("#interview_date_pseudo").innerWidth()+2)},
0)},orientation:"bottom"}).on("change",function(){if($("#"+id).val()){var selected_date=$("#"+id).val();$("#"+id+"_pseudo  .default").hide();$("#"+id+"_pseudo  .value").show();$("#"+id+"_pseudo  .value span").html(selected_date);update_interview_time_slot(selected_date)}else{$("#"+id+"_pseudo  .default").show();$("#"+id+"_pseudo  .value span").hide()}$("#interview_reschedule_form").validate().element("#interview_date")});$("#"+div_id).click(function(){$("#"+id+"_pseudo  .default").show();$("#"+id+
"_pseudo  .value").hide();$("#"+id).val("");$("#"+id+"_pseudo  .value span").html("");$("#"+id).datepicker("show")});$(document).on("click","#"+div_id+" .date_clear",function(){$("#"+id+"_pseudo  .default").show();$("#"+id+"_pseudo  .value").hide();$("#"+id).val("");$("#"+id+"_pseudo  .value span").html("")})}
function update_interview_time_slot(scheduled_interview_time){scheduled_interview_time=scheduled_interview_time===undefined?null:scheduled_interview_time;var today=new Date;var interview_date_datepicker=$("#interview_date").val()?$("#interview_date").val().replace("'",""):"";var formatted_selcted_date=new Date(interview_date_datepicker);if(today.toDateString()==formatted_selcted_date.toDateString())if(window.interview_duration==="60")update_interview_time_option(formatted_selcted_date,"60",true,scheduled_interview_time);
else update_interview_time_option(formatted_selcted_date,"30",true,scheduled_interview_time);else if(window.interview_duration==="60")update_interview_time_option(formatted_selcted_date,"60",false,scheduled_interview_time);else update_interview_time_option(formatted_selcted_date,"30",false,scheduled_interview_time)}
function update_interview_time_option(selected_date,duration,is_today,scheduled_interview_time){is_today=is_today===undefined?false:is_today;scheduled_interview_time=scheduled_interview_time===undefined?null:scheduled_interview_time;var scheduled_interview_data_on_selected_date=[];if(scheduled_interview_data!=undefined)scheduled_interview_data.forEach(function(item,index){var interview_start_date_time=new Date(item.start_date_time.date);if(interview_start_date_time.getDate()==selected_date.getDate())scheduled_interview_data_on_selected_date.push(item)});
$("#interview_timing").empty();$("#interview_timing").trigger("chosen:updated");var times=[];var today=new Date;var tt;if(!is_today)tt=0;else if(duration==60)tt=today.getMinutes()!=0?(today.getHours()+1)*60:today.getHours()*60;else{var current_minutes=today.getMinutes();if(current_minutes<30)tt=today.getHours()*60+30;else if(current_minutes>30)tt=today.getHours()*60+60;else tt=today.getHours()*60}var ap=["AM","PM"];var hh=Math.floor(tt/60);var mm=tt%60;var disabeled="";var student_name="";var reset_paused_on;
for(var i=0;tt<24*60;i++){disabeled="";student_name="";scheduled_interview_data_on_selected_date.forEach(function(item,index){var interview_start_date_time=new Date(item.start_date_time.date);if(duration==60&&item.duration==30&&interview_start_date_time.getHours()==hh){disabeled="disabled";student_name="Interview with "+item.first_name+" "+item.last_name}else if(duration==60&&item.duration==60&&interview_start_date_time.getHours()==hh&&interview_start_date_time.getMinutes()==mm){disabeled="disabled";
student_name="Interview with "+item.first_name+" "+item.last_name}else if(duration==30&&item.duration==60&&interview_start_date_time.getHours()==hh){reset_paused_on=i;disabeled="disabled";student_name="Interview with "+item.first_name+" "+item.last_name}else if(duration==30&&item.duration==30&&interview_start_date_time.getHours()==hh&&interview_start_date_time.getMinutes()==mm){disabeled="disabled";student_name="Interview with "+item.first_name+" "+item.last_name}});times[i]=("0"+(hh==0?12:hh%12==
0?12:hh%12)).slice(-2)+":"+("0"+mm).slice(-2)+" "+ap[Math.floor(hh/12)];tt=parseInt(tt)+parseInt(duration);hh=Math.floor(tt/60);mm=tt%60;times[i]+=" - "+("0"+(hh==0?12:hh%12==0?12:hh%12)).slice(-2)+":"+("0"+mm).slice(-2)+" "+ap[Math.floor(hh/12)<2?Math.floor(hh/12):0];var value=times[i];var selected="";if(scheduled_interview_time&&value==scheduled_interview_time)selected="selected";if(selected!=""&&disabeled!="")var newOption=$('<option id="'+value+'" '+selected+" value='"+value+"'>"+value+"</option>");
else var newOption=$('<option id="'+value+'" '+selected+" "+disabeled+" value='"+value+"'>"+value+"</option>");$("#interview_timing").append(newOption);if(disabeled!=""){var newOption1=$("<option class='append-icon' "+disabeled+" > "+student_name+"</option>");$("#interview_timing").append(newOption1)}}$("#interview_timing").trigger("chosen:updated")}
function interview_reply_success(data){if(!data.success)error_modal(data.errorThrown);else{Chat.onStudentInterviewReplyInReact(data.data);reset_interview_modal();$(".interview-modal").modal("hide")}NProgress.done()}function reschedule_interview_success(data){if(!data.success)error_modal(data.errorThrown);else{Chat.onStudentInterviewRescheduleInReact(data.data);reset_interview_modal();$(".interview-modal").modal("hide")}NProgress.done()}
function reset_interview_modal(){reset_form_validations("interview_accept_form");reset_form_validations("interview_decline_form");$("#interview_message_input").val("");$("label.form-error").empty();textarea_char_count()};function AudioRecorder(controllerContainerDom){var $jscomp$this=this;this.controllerContainerDom=controllerContainerDom;this.state={type:"INACTIVE"};this.audioBlobs=[];this.blobObject=null;this.mediaRecorder=null;this.streamBeingCaptured=null;this.audioSourceElement=null;this.recorderTimeout=null;this.attachEventListeners=function(){$jscomp$this.controllerContainerDom.querySelector(".start .icon").addEventListener("click",function(){$jscomp$this.start().then(function(){$jscomp$this.state={type:"RECORDING"};
$jscomp$this.recorderTimeout=setTimeout(function(){$jscomp$this.controllerContainerDom.querySelector(".stop .icon").click()},3*60*1E3)})["catch"](function(err){var messageToShow="";console.error(err.name+": "+err.message);switch(err.name){case "NotAllowedError":messageToShow="Unable to use your microphone. Use the browser's settings to allow access";break;default:messageToShow="This feature is not supported on your browser"}$jscomp$this.state={type:"ERROR",payload:messageToShow}})["finally"](function(){$jscomp$this.renderControllersForState()})});
$jscomp$this.controllerContainerDom.querySelector(".stop .icon").addEventListener("click",function(){$jscomp$this.stop().then(function(blob){$jscomp$this.blobObject=blob;$jscomp$this.state={type:"SAVING"};setTimeout(function(){var audioElementDom=$jscomp$this.controllerContainerDom.querySelector(".audio-element");$jscomp$this.save(audioElementDom).then(function(){$jscomp$this.state={type:"STOPPED"};$jscomp$this.renderControllersForState()})},500)})["catch"](function(err){console.error(err.name+": "+
err.message);$jscomp$this.state={type:"ERROR",payload:"Something went wrong while saving audio"}})["finally"](function(){$jscomp$this.renderControllersForState()})});$jscomp$this.controllerContainerDom.querySelector(".play .icon").addEventListener("click",function(){var audioElementDom=$jscomp$this.controllerContainerDom.querySelector(".audio-element");audioElementDom.onended=function(){$jscomp$this.state={type:"STOPPED"};$jscomp$this.renderControllersForState()};if($jscomp$this.state.type==="STOPPED"||
$jscomp$this.state.type==="PAUSED"){$jscomp$this.state={type:"PLAYING"};audioElementDom.play()}else{$jscomp$this.state={type:"PAUSED"};audioElementDom.pause()}$jscomp$this.renderControllersForState()})};this.renderControllersForState=function(){$jscomp$this.controllerContainerDom.querySelectorAll(".controller").forEach(function(controllerDom){controllerDom.classList.add("hide")});switch($jscomp$this.state.type){case "INACTIVE":case "STOPPED":case "PLAYING":case "PAUSED":{var startControllerDom=$jscomp$this.controllerContainerDom.querySelector(".start");
startControllerDom.classList.remove("hide");startControllerDom.querySelector("label").innerText="Record"+($jscomp$this.audioBlobs.length?" again":"");if($jscomp$this.state.type==="PLAYING"){var playControllerDom=$jscomp$this.controllerContainerDom.querySelector(".play");playControllerDom.querySelector(".icon i").className="ic-24-filled-pause";playControllerDom.classList.remove("hide");startControllerDom.classList.add("disabled")}else startControllerDom.classList.remove("disabled");if($jscomp$this.state.type===
"STOPPED"||$jscomp$this.state.type==="PAUSED"){var playControllerDom$0=$jscomp$this.controllerContainerDom.querySelector(".play");playControllerDom$0.querySelector(".icon i").className="ic-24-filled-play";playControllerDom$0.classList.remove("hide")}break}case "RECORDING":{$jscomp$this.controllerContainerDom.querySelector(".stop").classList.remove("hide");break}case "ERROR":{var errorControllerDom=$jscomp$this.controllerContainerDom.querySelector(".error");errorControllerDom.querySelector("label").innerText=
$jscomp$this.state.payload;errorControllerDom.classList.remove("hide");break}case "SAVING":{$jscomp$this.controllerContainerDom.querySelector(".saving").classList.remove("hide");break}}};this.start=function(){if(!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia))return Promise.reject(new Error("mediaDevices API or getUserMedia method is not supported in this browser."));return navigator.mediaDevices.getUserMedia({audio:true}).then(function(stream){$jscomp$this.streamBeingCaptured=stream;
$jscomp$this.mediaRecorder=new MediaRecorder(stream);$jscomp$this.audioBlobs=[];$jscomp$this.mediaRecorder.addEventListener("dataavailable",function(event){$jscomp$this.audioBlobs.push(event.data)});$jscomp$this.mediaRecorder.start()})};this.stop=function(){return new Promise(function(resolve){var mimeType=$jscomp$this.mediaRecorder.mimeType;$jscomp$this.mediaRecorder.addEventListener("stop",function(){var audioBlob=new Blob($jscomp$this.audioBlobs,{type:mimeType});resolve(audioBlob)});$jscomp$this.cancel()})};
this.cancel=function(){$jscomp$this.mediaRecorder.stop();$jscomp$this.streamBeingCaptured.getTracks().forEach(function(track){return track.stop()})};this.save=function(audioElementDom){return new Promise(function(resolve){var reader=new FileReader;reader.onload=function(e){var base64URL=e.target.result;if(!$jscomp$this.audioSourceElement){var sourceElement=document.createElement("source");audioElementDom.appendChild(sourceElement);$jscomp$this.audioSourceElement=sourceElement}$jscomp$this.audioSourceElement.src=
base64URL;$jscomp$this.audioSourceElement.type=$jscomp$this.blobObject.type.includes(";")?$jscomp$this.blobObject.type.substr(0,$jscomp$this.blobObject.type.indexOf(";")):$jscomp$this.blobObject.type;audioElementDom.load();resolve()};reader.readAsDataURL($jscomp$this.blobObject)})};this.resetRecordingProperties=function(){if($jscomp$this.state.type==="RECORDING")$jscomp$this.cancel();else if($jscomp$this.state.type==="PLAYING"){var audioElementDom=$jscomp$this.controllerContainerDom.querySelector(".audio-element");
audioElementDom.pause();audioElementDom.currentTime=0}$jscomp$this.mediaRecorder=null;$jscomp$this.streamBeingCaptured=null;$jscomp$this.state={type:"INACTIVE"};$jscomp$this.audioBlobs=[];$jscomp$this.blobObject=null;if($jscomp$this.audioSourceElement){$jscomp$this.audioSourceElement.remove();$jscomp$this.audioSourceElement=null}clearTimeout($jscomp$this.recorderTimeout);$jscomp$this.recorderTimeout=null};this.attachEventListeners()};var assignment_files=[];var max_assignment_files=3;var max_assignment_file_size=50;var assignment_files_count=0;var total_assignment_file_size=0;var max_file_count_msg="You can share a maximum of "+max_assignment_files+" attachments";var max_file_size_msg="Total permitted file upload size is "+max_assignment_file_size+" MB";var audioRecorder=null;
$(document).ready(function(){$("#assignment_form").validate({onfocusout:function(element){this.element(element)},rules:{message:{required:true,maxlength:2048},assignment_link:{url:true}},errorPlacement:function(label,element){if(element.parent(".has_char_count").length){var parent=element.parent(".has_char_count");label.insertAfter(parent)}else if(element[0].name=="submission_deadline")$("#datepicker_form_field").append(label);else if(element.parent(".assignment_link_input").length){var parent=element.parent(".assignment_link_input");
label.insertAfter(parent)}else label.insertAfter(element)},highlight:function(label){if($(label).attr("id")==="assignment_link"){$(label).closest(".assignment_link_input").addClass("has-error");$(label).closest(".assignment_link_input").removeClass("has-success")}$(label).closest(".form-group").addClass("has-error");$(label).closest(".form-group").removeClass("has-success");$(label).closest("input").addClass("error");$(label).closest("input").removeClass("valid")},success:function(label){if($(label).attr("id")===
"assignment_link-error"){$(label).closest(".form-group").find(".assignment_link_input").addClass("has-success");$(label).closest(".form-group").find(".assignment_link_input").removeClass("has-error")}$(label).closest(".form-group").addClass("has-success");$(label).closest(".form-group").removeClass("has-error");$(label).closest("input").addClass("valid");$(label).closest("input").removeClass("error")},submitHandler:function(){add_url_to_attachments_on_submit();var form=document.querySelector("#assignment_form");
var fd=new FormData(form);var i=1;for(var key in assignment_files){fd.append("attachment_"+i,assignment_files[key]);i++}fd.append("chat_conversation_id",window.conversation_id);fd["delete"]("assignment_link");if(window.is_audio_assignment)if(Object.keys(assignment_files).length===0&&audioRecorder.blobObject===null){show_attachments_warning_msg("Please record or upload an audio file");return false}else $("#assignment_alert").hide();if(audioRecorder&&audioRecorder.blobObject)fd.append("attachment_"+
i,audioRecorder.blobObject,"student_assignment_recorded_audio.webm");NProgress.start();$.ajax("/chat/submit_assignment",{data:fd,processData:false,contentType:false,success:assignment_success,error:onError,type:"POST"});return false}});$("body").on("click",".submit_assignment_cta",function(){setTimeout(function(){check_and_render_assignment_form_fields();if(window.is_audio_assignment){document.querySelector("#assignment_form .attachments_description").innerHTML="\n                    <span>Maximum file size 10 MB</span>\n                    <span> \u2022 </span>\n                    <span>Only mp3, aac, wav, aiff allowed</span>\n                ";
if(audioRecorder===null)audioRecorder=new AudioRecorder(document.querySelector("#student_assignment_submit_modal .audio-controllers"));audioRecorder.renderControllersForState()}else document.querySelector("#assignment_form .attachments_description").innerHTML="\n                    <span>Maximum combined file size 50 MB</span>\n                    <span> \u2022 </span>\n                    <span>Only zip, pdf, doc, ppt, xls, png, jpg, mp3, mp4 allowed</span>\n                ";$("#student_assignment_submit_modal").modal("show")},
50)});$("#assignment_files").change(function(){$("#assignment_alert").hide();if(max_assignment_file_size*1024*1024<total_assignment_file_size)show_attachments_warning_msg(max_file_size_msg);else read_files(this);$("#assignment_files").val("")});$(document).on("click",".file_preview_container .frame-close",function(e){var file_name=$(this).attr("file_name");$(e.target).closest(".frame-container").remove();if(typeof assignment_files[file_name]!="undefined"){var size=assignment_files[file_name].size;
total_assignment_file_size-=size;delete assignment_files[file_name];assignment_files_count--}if(assignment_files_count===0)$("#student_assignment_submit_modal .file_preview_container").hide();$("#assignment_link").attr("disabled",false);$("#assignment_files").attr("disabled",false);$("#assignment_alert").hide()});$(document).on("input","#assignment_link",function(e){if(e.target.value.length>0)$("#add_assignment_link").attr("disabled",false);else{$(".assignment_link_input").removeClass("has-error");
$("#add_assignment_link").attr("disabled",true)}});$(document).on("click","#add_assignment_link",function(){if($("#assignment_link").valid())add_url_to_attachments()});$("#student_assignment_submit_modal").on("hidden.bs.modal",function(){reset_assignment_modal()});textarea()});
function check_and_render_assignment_form_fields(){var assignmentLinkContainerDom=document.querySelector("#student_assignment_submit_modal .assignment_link_container");var notesContainerDom=document.querySelector("#student_assignment_submit_modal .notes_container");var audioRecorderContainerDom=document.querySelector("#student_assignment_submit_modal .audio-recorder-container");if(window.is_audio_assignment){assignmentLinkContainerDom.style.display="none";notesContainerDom.style.display="none";audioRecorderContainerDom.style.display=
"block"}else{assignmentLinkContainerDom.style.display="block";notesContainerDom.style.display="block";audioRecorderContainerDom.style.display="none"}}function assignment_success(data){if(!data.success)error_modal(data.errorThrown);else{Chat.onStudentSubmitAssignmentInReact(data.data);reset_assignment_modal();$("#student_assignment_submit_modal").modal("hide");general_toast("Assignment submitted. You will hear from the employer if they like the assignment.")}NProgress.done()}
function add_url_to_attachments(){$("#assignment_alert").hide();var url=$("#assignment_link").val();if(typeof assignment_files[url]==="undefined"){assignment_files[url]=url;$("#student_assignment_submit_modal .file_preview_container").show();$("#student_assignment_submit_modal .file_preview_container").append(create_preview_template_for_assignment_link(url));assignment_files_count++;$("#assignment_link").val("");$("#add_assignment_link").attr("disabled",true)}if(assignment_files_count===max_assignment_files){$("#add_assignment_link").attr("disabled",
true);$("#assignment_link").attr("disabled",true);$("#assignment_files").attr("disabled",true);show_attachments_warning_msg(max_file_count_msg)}}function add_url_to_attachments_on_submit(){if(assignment_files_count<max_assignment_files){var url=$("#assignment_link").val();url=url&&url.trim()||null;if(url&&typeof assignment_files[url]==="undefined"){assignment_files[url]=url;assignment_files_count++;$("#assignment_link").val("")}}}
function show_attachments_warning_msg(text){$("#assignment_alert_msg").html(text);$("#assignment_alert").show()}function read_files(input){var input_files=input.files;var fc=input_files.length;if(fc>max_assignment_files||assignment_files_count+fc>max_assignment_files){show_attachments_warning_msg(max_file_count_msg);return}else for(i=0;i<fc;i++){var files=input_files[i];validate_file_extension(files,assignment_file_check_call_back)}}
function assignment_file_check_call_back(success,msg,file){if(!success)show_attachments_warning_msg(msg);else{var file_size=compute_file_size(file.size);var fileExt=file.name.split(".").slice(-1)[0];var ext=["zip","pdf","doc","docx","ppt","pptx","xls","xlsx","png","jpg","jpeg","mp3","aac","wav","aiff","mp4","mov","wmv","avi","flv","webm","m4a","opus"];if(ext.includes(fileExt))if(typeof assignment_files[file.name]==="undefined"){total_assignment_file_size+=file.size;if(max_assignment_file_size*1024*
1024<total_assignment_file_size){show_attachments_warning_msg(max_file_size_msg);total_assignment_file_size-=file.size}else{assignment_files_count++;assignment_files[file.name]=file;$("#student_assignment_submit_modal .file_preview_container").show();$("#student_assignment_submit_modal .file_preview_container").append(create_preview_template_for_assignment_attachments(assignment_files_count,file.name,file_size,fileExt.toUpperCase()))}}}if(assignment_files_count===max_assignment_files){$("#assignment_link").val("");
$("#add_assignment_link").attr("disabled",true);$("#assignment_link").attr("disabled",true);$("#assignment_files").attr("disabled",true);$(".assignment_link_input").removeClass("has-error");$(".assignment_link_container").removeClass("has-error");show_attachments_warning_msg(max_file_count_msg)}if(assignment_files_count>max_assignment_files)show_attachments_warning_msg(max_file_count_msg)}
function create_preview_template_for_assignment_attachments(count,name,size,ext){var html='\n        <div class="frame-container preview_container_'+count+'">\n            <div class="file-extension '+ext.toLowerCase()+'">'+ext+'</div>\n            <div class="file-name">'+name+'</div>\n            <span class="dot"></span>\n            <div class="file-size">'+size+'</div>\n            <button type="button" class="download-button frame-close" file_name="'+name+'">\n                <i class="ic-24-multiply"></i>\n            </button>\n        </div>\n    ';
return html}function create_preview_template_for_assignment_link(url){return'\n        <div class="frame-container">\n            <div class="file-extension link">\n                <i class="ic-24-link"></i>\n            </div>\n            <div class="file-name">'+url+'</div>\n            <button type="button" class="download-button frame-close" file_name="'+url+'">\n                <i class="ic-24-multiply"></i>\n            </button>\n        </div>\n    '}
function reset_assignment_modal(){assignment_files=[];assignment_files_count=0;total_assignment_file_size=0;reset_form_validations("assignment_form");$("#assignment_form .file_preview_container").html("");$("#assignment_form .file_preview_container").css("display","none");$("#assignment_message_input").val("");$("label.form-error").empty();$("#assignment_alert").hide();$("#assignment_link").val("");$("#add_assignment_link").attr("disabled",true);$("#assignment_link").attr("disabled",false);$("#assignment_files").attr("disabled",
false);$(".assignment_link_input").removeClass("has-error");$(".assignment_link_container").removeClass("has-error");textarea_char_count();if(audioRecorder)audioRecorder.resetRecordingProperties()};$(document).ready(function(){$("#student_connect_report_form").validate({onfocusout:function(element){this.element(element)},ignore:"",rules:{query_data:{required:true,minlength:50,maxlength:2048}},errorPlacement:function(label,element){label.insertAfter(element)},highlight:function(label){$(label).closest(".form-group").addClass("has-error");$(label).closest(".form-group").removeClass("has-success");$(label).closest("input").addClass("error");$(label).closest("input").removeClass("valid")},success:function(label){$(label).closest(".form-group").addClass("has-success");
$(label).closest(".form-group").removeClass("has-error");$(label).closest("input").addClass("valid");$(label).closest("input").removeClass("error")},submitHandler:function(_,e){var data=$("#student_connect_report_form").serialize();e.preventDefault();NProgress.start();$.ajax("/student/query_box_submit",{data:data,success:student_connect_report_success,error:onError,type:"POST"});return false}})});
var open_student_connect_report_modal=function(conversation_id,is_blocked){$("#student_connect_report_form #conversation_id").val(conversation_id);if(is_blocked)$("#student_connect_report_form .should_block").css("display","none");else $("#student_connect_report_form .should_block").css("display","flex");$("#student_connect_report_modal").modal("show")};
var student_connect_report_success=function(data){try{NProgress.done();$("#student_connect_report_modal").modal("hide");if(data.success){success_modal("Thank you for reporting the user. It will help us build a safer community. We will take the necessary action and get in touch with you if we require any more details.",null,"OK","We got your report",true);var conversation_id=$("#student_connect_report_form #conversation_id").val();Chat.onJobReportSuccessInReact({conversationId:conversation_id,blockedSuccess:data.blocked_success});
$("#student_connect_report_form")[0].reset()}else throw_error(data.errorThrown)}catch(e){throw_error(e);NProgress.done();$(".loading_image").hide()}};function show_helper_onboarding_modal(chat_conversation_id){var url="/connect/to_show_helper_onboarding_modal/"+chat_conversation_id;$.ajax(url,{success:helper_onboarding_modal_success,error:onError,type:"GET"})}var helper_onboarding_modal_success=function(data){try{if(data.to_show_onboarding_modal)$("#helper_onboarding_modal").modal({backdrop:"static",keyboard:false},"show")}catch(e){throw_error(e)}};
